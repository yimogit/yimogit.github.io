import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,e as a,o as i}from"./app-CzakNbIb.js";const l="/assets/662652-20240120162959557-950502628-CNi6wiJ9.png",p="/assets/662652-20240120162959570-1948272292-CG8babVo.png",r={};function t(d,s){return i(),e("div",null,s[0]||(s[0]=[a(`<p>之前分享了 <a href="https://www.cnblogs.com/morang/p/devops-nginx-install-use.html" target="_blank" rel="noopener noreferrer">前后端都用得上的 Nginx 日常使用经验</a> ，在配置 elk 的时候增加了nginx basic auth 和 IP百名的配置，作为补充分享。</p><h2 id="配置-nginx-域名转发" tabindex="-1"><a class="header-anchor" href="#配置-nginx-域名转发"><span>配置 nginx 域名转发</span></a></h2><p>常规的转发配置，不需要https部分去掉即可，一般只需要修改域名和转发地址</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>server {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    listen 80;</span></span>
<span class="line"><span>    listen       443 ssl;</span></span>
<span class="line"><span>    server_name kibana.devops.test.com;  # 自行修改成你的域名</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    ssl_certificate      /certs/kibana.devops.test.com/server.crt;</span></span>
<span class="line"><span>    ssl_certificate_key  /certs/kibana.devops.test.com/server.key;</span></span>
<span class="line"><span>    ssl_session_cache    shared:SSL:1m;</span></span>
<span class="line"><span>    ssl_session_timeout  5m;</span></span>
<span class="line"><span>    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span>
<span class="line"><span>    ssl_prefer_server_ciphers  on;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    location / {</span></span>
<span class="line"><span>            proxy_pass http://192.168.123.102:5601;</span></span>
<span class="line"><span>            proxy_http_version 1.1;</span></span>
<span class="line"><span>            proxy_buffering off;</span></span>
<span class="line"><span>            proxy_request_buffering off;</span></span>
<span class="line"><span>            proxy_set_header Upgrade $http_upgrade;</span></span>
<span class="line"><span>            proxy_set_header Connection &quot;upgrade&quot;;</span></span>
<span class="line"><span>            proxy_set_header Host $host;</span></span>
<span class="line"><span>            proxy_set_header X-Forwarded-For $remote_addr;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置-nginx-基本认证" tabindex="-1"><a class="header-anchor" href="#配置-nginx-基本认证"><span>配置 nginx 基本认证</span></a></h2><p>用于对未提供账号密码登录的服务添加一个前置基本验证 Basic Auth，在Nginx配置文件中添加以下内容指定密码文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>location / {</span></span>
<span class="line"><span>    auth_basic &quot;Restricted Content&quot;;</span></span>
<span class="line"><span>    # htpasswd 密码文件</span></span>
<span class="line"><span>    auth_basic_user_file /certs/kibana.devops.test.com/passwd;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>添加对应的 passwd 文件，使用 htpasswd 生成，如账号密码是 root devops666 的配置文件,多个账号换行添加即可</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>root:WvesKBTr22.wY</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>可以使用我 <a href="https://github.com/yimogit/metools-plugin" target="_blank" rel="noopener noreferrer">metools</a> 工具的 <a href="https://metools.js.org/#/genpwd" target="_blank" rel="noopener noreferrer">密码生成器</a> 生成</p><figure><img src="`+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>配置完成，重载配置后刷新页面就提示输入账号密码了</p><figure><img src="'+p+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="配置-nginx-ip白名单" tabindex="-1"><a class="header-anchor" href="#配置-nginx-ip白名单"><span>配置 nginx IP白名单</span></a></h2><p>如下所示，能够只允许 192.168.123.201及10.0.0.0/24网段的IP访问此路径</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>location / {</span></span>
<span class="line"><span>    allow 192.168.123.201;   # 允许的IP地址</span></span>
<span class="line"><span>    allow 10.0.0.0/24; # 允许10.0.0.0/24网段的IP地址</span></span>
<span class="line"><span>    deny all;              # 拒绝所有其他IP地址</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最后" tabindex="-1"><a class="header-anchor" href="#最后"><span>最后</span></a></h2><p>修改了配置文件记得重载配置文件： <code>nginx -s reload</code></p>`,18)]))}const h=n(r,[["render",t],["__file","front_and_rear_useful_come_in_handy_nginx_daily_use_exp_replenishment.html.vue"]]),v=JSON.parse('{"path":"/posts/web/front_and_rear_useful_come_in_handy_nginx_daily_use_exp_replenishment.html","title":"前后端都用得上的 Nginx 日常使用经验-补充篇","lang":"zh-CN","frontmatter":{"title":"前后端都用得上的 Nginx 日常使用经验-补充篇","date":"2024-01-20T16:32:00.000Z","category":["Web"],"tag":["nginx"],"description":"之前分享了 前后端都用得上的 Nginx 日常使用经验 ，在配置 elk 的时候增加了nginx basic auth 和 IP百名的配置，作为补充分享。 配置 nginx 域名转发 常规的转发配置，不需要https部分去掉即可，一般只需要修改域名和转发地址 配置 nginx 基本认证 用于对未提供账号密码登录的服务添加一个前置基本验证 Basic A...","head":[["meta",{"property":"og:url","content":"https://www.yimo.link/posts/web/front_and_rear_useful_come_in_handy_nginx_daily_use_exp_replenishment.html"}],["meta",{"property":"og:site_name","content":"易墨网"}],["meta",{"property":"og:title","content":"前后端都用得上的 Nginx 日常使用经验-补充篇"}],["meta",{"property":"og:description","content":"之前分享了 前后端都用得上的 Nginx 日常使用经验 ，在配置 elk 的时候增加了nginx basic auth 和 IP百名的配置，作为补充分享。 配置 nginx 域名转发 常规的转发配置，不需要https部分去掉即可，一般只需要修改域名和转发地址 配置 nginx 基本认证 用于对未提供账号密码登录的服务添加一个前置基本验证 Basic A..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-28T11:15:42.000Z"}],["meta",{"property":"article:tag","content":"nginx"}],["meta",{"property":"article:published_time","content":"2024-01-20T16:32:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-28T11:15:42.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"前后端都用得上的 Nginx 日常使用经验-补充篇\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-01-20T16:32:00.000Z\\",\\"dateModified\\":\\"2024-10-28T11:15:42.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"易墨\\",\\"url\\":\\"https://www.yimo.link\\"}]}"]]},"headers":[{"level":2,"title":"配置 nginx 域名转发","slug":"配置-nginx-域名转发","link":"#配置-nginx-域名转发","children":[]},{"level":2,"title":"配置 nginx 基本认证","slug":"配置-nginx-基本认证","link":"#配置-nginx-基本认证","children":[]},{"level":2,"title":"配置 nginx IP白名单","slug":"配置-nginx-ip白名单","link":"#配置-nginx-ip白名单","children":[]},{"level":2,"title":"最后","slug":"最后","link":"#最后","children":[]}],"git":{"createdTime":1730114142000,"updatedTime":1730114142000,"contributors":[{"name":"yimo","email":"yimo@wikiglobal.com","commits":1}]},"readingTime":{"minutes":1.37,"words":412},"filePathRelative":"posts/web/front_and_rear_useful_come_in_handy_nginx_daily_use_exp_replenishment.md","localizedDate":"2024年1月20日","excerpt":"<p>之前分享了 <a href=\\"https://www.cnblogs.com/morang/p/devops-nginx-install-use.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">前后端都用得上的 Nginx 日常使用经验</a> ，在配置 elk 的时候增加了nginx basic auth 和 IP百名的配置，作为补充分享。</p>\\n<h2>配置 nginx 域名转发</h2>\\n<p>常规的转发配置，不需要https部分去掉即可，一般只需要修改域名和转发地址</p>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" data-title=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>server {</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    listen 80;</span></span>\\n<span class=\\"line\\"><span>    listen       443 ssl;</span></span>\\n<span class=\\"line\\"><span>    server_name kibana.devops.test.com;  # 自行修改成你的域名</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    ssl_certificate      /certs/kibana.devops.test.com/server.crt;</span></span>\\n<span class=\\"line\\"><span>    ssl_certificate_key  /certs/kibana.devops.test.com/server.key;</span></span>\\n<span class=\\"line\\"><span>    ssl_session_cache    shared:SSL:1m;</span></span>\\n<span class=\\"line\\"><span>    ssl_session_timeout  5m;</span></span>\\n<span class=\\"line\\"><span>    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span>\\n<span class=\\"line\\"><span>    ssl_prefer_server_ciphers  on;</span></span>\\n<span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>    location / {</span></span>\\n<span class=\\"line\\"><span>            proxy_pass http://192.168.123.102:5601;</span></span>\\n<span class=\\"line\\"><span>            proxy_http_version 1.1;</span></span>\\n<span class=\\"line\\"><span>            proxy_buffering off;</span></span>\\n<span class=\\"line\\"><span>            proxy_request_buffering off;</span></span>\\n<span class=\\"line\\"><span>            proxy_set_header Upgrade $http_upgrade;</span></span>\\n<span class=\\"line\\"><span>            proxy_set_header Connection \\"upgrade\\";</span></span>\\n<span class=\\"line\\"><span>            proxy_set_header Host $host;</span></span>\\n<span class=\\"line\\"><span>            proxy_set_header X-Forwarded-For $remote_addr;</span></span>\\n<span class=\\"line\\"><span>    }</span></span>\\n<span class=\\"line\\"><span>}</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{h as comp,v as data};
