import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as i,a as l,e,o as p}from"./app-f_uNzTRF.js";const t={};function h(k,s){return p(),a("div",null,[s[0]||(s[0]=i("h2",{id:"站点缓存着实头痛-那么-重启吧",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#站点缓存着实头痛-那么-重启吧"},[i("span",null,"站点缓存着实头痛，那么~重启吧")])],-1)),s[1]||(s[1]=i("blockquote",null,[i("p",null,"网站做了站点缓存，测试的时候修改数据后需要重启站点来清楚缓存")],-1)),s[2]||(s[2]=i("blockquote",null,[i("p",null,"如何无需登陆服务器又不用改代码就可以清理换网站上的缓存呢？")],-1)),s[3]||(s[3]=i("blockquote",null,[i("p",null,"用重启iis怎么样~")],-1)),s[4]||(s[4]=i("blockquote",null,[i("p",null,"能重启IIS，自然也能干其他的")],-1)),l("more"),s[5]||(s[5]=e(`<h2 id="实现步骤" tabindex="-1"><a class="header-anchor" href="#实现步骤"><span>实现步骤</span></a></h2><ol start="0"><li><p>连接到远程主机</p></li><li><p>在远程主机一个创建一个包含iisreset命令(+移除计划任务)的脚本</p></li><li><p>给远程主机添加一项过期的计划任务</p></li><li><p>立即执行计划任务</p></li></ol><h2 id="完整批处理脚本-重启iis-bat" tabindex="-1"><a class="header-anchor" href="#完整批处理脚本-重启iis-bat"><span>完整批处理脚本- 重启iis.bat</span></a></h2><div class="language-bat line-numbers-mode" data-highlighter="shiki" data-ext="bat" data-title="bat" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> off</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 远程地址</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> ycip</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">192.168.1.123</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 服务器登陆名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> ycname</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Administrator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 服务器登陆密码</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> ycpwd</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">123456</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 计划任务名称</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> planName</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">自动重启IIS</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> ipc名称</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> ipcName</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 执行脚本地址 \\\\%ycip%\\%ipcName%$\\ 对应C:\\Windows</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> execbat</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ipcName%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$\\Temp\\execiisresest.bat</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 执行路径</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> taskPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">C:\\Windows\\Temp\\execiisresest.bat</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 建立远程连接</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">net use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \\\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ipcName%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ycpwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /user:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycname%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 写入脚本到远程脚本</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> ....写日志 未写入可能是权限问题</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%time%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">执行任务</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;C:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\Windows</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\Temp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\iisreset_log.txt&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%execbat%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> ....重启IIS</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> iisreset&gt;&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%execbat%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> ....删除计划任务 echo yes</span><span style="--shiki-light:white;--shiki-light-font-style:italic;--shiki-dark:#FFFFFF;--shiki-dark-font-style:italic;">|</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 始终确认</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> echo yes</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SCHTASKS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /Delete /TN </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">planName</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /F&gt;&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%execbat%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 任务时间 设置一个过期时间，但是立即执行</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> tasktime</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;00:00&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 在远程主机创建计划任务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SCHTASKS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /Create /S </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /U </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycname%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /P </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ycpwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /SC ONCE /ST </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%tasktime%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /TN </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%planName%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /TR </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%taskPath%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /RU </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycname%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /F</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 立即执行定义的计划任务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SCHTASKS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /Run /S </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /U </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycname%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /P </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ycpwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /I /TN </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">planName</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-light-font-style:italic;--shiki-dark:#C678DD;--shiki-dark-font-style:italic;">REM</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 删除IPC连接</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">net use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> \\\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ycip%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">%ipcName%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ /del</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>---------------手动分割线---------------</p><p>使用上面的方法若无权限问题可无碍运行，然在某些做了安全设置的情况下貌似有点走不通，故有了下面的版本</p><h2 id="第二次修改" tabindex="-1"><a class="header-anchor" href="#第二次修改"><span>第二次修改</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>@echo off</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 远程地址</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set ycip=192.169.1.123</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 服务器登陆名</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set ycname=Administrator</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 服务器登陆密码</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set ycpwd=123456</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 计划任务名称</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set planName=IIS_Reset</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 远程计算机名</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set ycpcname=mypc</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 执行脚本地址</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set execbat=\\\\%ycip%\\D$\\\\execiisresest.bat</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set taskPath=D:\\execiisresest.bat</span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo 建立远程连接</span></span>
<span class="line"><span></span></span>
<span class="line"><span>net use \\\\%ycip% &quot;%ycpwd%&quot; /user:%ycpcname%\\%ycname%</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo 写入脚本到远程脚本</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM ....写日志 未写入可能是权限问题</span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo echo %time%执行任务^&gt;^&gt;%taskPath%.txt&gt;%execbat%</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM ....重启IIS</span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo iisreset&gt;&gt;%execbat%</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM ....删除计划任务 echo yes| 始终确认</span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo echo yes^| SCHTASKS /Delete /TN &quot;%planName%&quot; /F&gt;&gt;%execbat%</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 任务时间延迟</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set tasktime=&quot;00:00&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo 在远程主机创建计划任务</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>SCHTASKS /Create /S %ycip% /U %ycpcname%\\%ycname% /P &quot;%ycpwd%&quot; /SC ONCE /ST %tasktime% /TN %planName% /TR %taskPath% /RU %ycname% /F</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>echo 立即执行定义的计划任务</span></span>
<span class="line"><span></span></span>
<span class="line"><span>SCHTASKS /Run /S %ycip% /U %ycpcname%\\%ycname% /P &quot;%ycpwd%&quot; /I /TN &quot;%planName%&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>REM 删除IPC连接</span></span>
<span class="line"><span></span></span>
<span class="line"><span>net use \\\\%ycip% /del</span></span>
<span class="line"><span></span></span>
<span class="line"><span>pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="关于脚本中的几个关键点" tabindex="-1"><a class="header-anchor" href="#关于脚本中的几个关键点"><span>关于脚本中的几个关键点</span></a></h2><ol><li><p>批处理脚本中如何定义变量？</p><p>定义：<code>set 变量名=值</code></p><p>使用：<code>%变量名%</code></p><p>计算：<code>set /a v1=1+1</code> --&gt;v1<mark>2 <code>set v2=1+1</code>--&gt;v2</mark>&quot;1+1&quot;</p></li><li><p>如何写入文件？</p><p>写入：<code>echo 我是文本&gt;文件名.后缀名</code></p><p>追加写入：<code>echo 我是文本&gt;&gt;文件名.后缀名</code></p><p>追加一个换行符：<code>echo. &gt;&gt;文件名.后缀名</code></p><p>自动确认yes：<code>echo yes|</code></p></li><li><p>如何写入文件到建立远程连接</p><p>首先建立远程连接： <code>net use \\\\192.168.1.123\\admin$ &quot;密码&quot; /user:登陆名</code> 路径对应C:\\Windows</p><p>写入文件：<code>echo 文本&gt;\\\\192.168.1.123\\admin$\\文件路径</code></p></li><li><p>在远程主机创建计划任务并执行</p><p>创建计划任务：<code>SCHTASKS /Create /S %主机地址% /U %主机地址%\\%主机登陆名% /P &quot;%密码%&quot; /SC ONCE /ST %计划任务名% /TN %计划任务名% /TR %脚本或程序地址% /RU %主机登录名亦可%</code></p><p>立即执行：<code>SCHTASKS /Run /S %主机地址% /U %主机地址%\\%主机登陆名% /P &quot;%密码%&quot; /I /TN &quot;%计划任务名%&quot;</code></p><p>删除任务：<code>SCHTASKS /Run /S %主机地址% /U %主机地址%\\%主机登陆名% /P &quot;%密码%&quot; /I /TN &quot;%计划任务名%&quot;</code></p></li><li><p>如何将 |,&gt; 等特殊字符写入文本</p><p>示例：<code>echo ^|&gt;xxx.txt</code> ^为转义字符，这样就能特殊字符输出或写入文件了</p></li><li><p>5种if语句的基本语法：</p></li></ol><blockquote><ol><li>判断两个字符串是否相等，<code>if &quot;字符串1&quot;==&quot;字符串2&quot;(command语句) else ()</code></li></ol></blockquote><blockquote><ol start="2"><li>判断两个数值是否相等，<code>if 数值1 equ 数值2 command语句</code></li></ol></blockquote><blockquote><ol start="3"><li>判断判断驱动器，文件或文件夹是否存在<code>if exist filename command语句</code></li></ol></blockquote><blockquote><ol start="4"><li>判断变量是否已经定义，<code>if defined 变量 command语句</code></li></ol></blockquote><blockquote><ol start="5"><li>判断上个命令的返回值，<code>if errorlevel 数值 command语句</code></li></ol></blockquote><ol start="7"><li>计划任务是会在C:\\Windows\\system32目录下执行的，所以若脚本中未重定向路径，则日志会保存到system32目录</li></ol><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章"><span>参考文章</span></a></h2><p>利用schtasks远程执行命令 https://sanwen.net/a/rsjveqo.html</p><p>DOS批处理中的特殊符号 http://www.2cto.com/os/201309/241025.html</p><p>DOS批处理添加任务计划 http://www.echojb.com/computer/2017/04/26/363341.html</p>`,20))])}const r=n(t,[["render",h],["__file","use_handle_batch_processing_script_cheerful_clear_cache.html.vue"]]),o=JSON.parse('{"path":"/posts/developer/use_handle_batch_processing_script_cheerful_clear_cache.html","title":"使用批处理脚本愉快的清理缓存","lang":"zh-CN","frontmatter":{"title":"使用批处理脚本愉快的清理缓存","date":"2017-06-04T02:08:00.000Z","category":["Developer"],"tag":["脚本"],"description":"站点缓存着实头痛，那么~重启吧 网站做了站点缓存，测试的时候修改数据后需要重启站点来清楚缓存 如何无需登陆服务器又不用改代码就可以清理换网站上的缓存呢？ 用重启iis怎么样~ 能重启IIS，自然也能干其他的 实现步骤 连接到远程主机 在远程主机一个创建一个包含iisreset命令(+移除计划任务)的脚本 给远程主机添加一项过期的计划任务 立即执行计划任...","head":[["meta",{"property":"og:url","content":"https://www.yimo.link/posts/developer/use_handle_batch_processing_script_cheerful_clear_cache.html"}],["meta",{"property":"og:site_name","content":"易墨网"}],["meta",{"property":"og:title","content":"使用批处理脚本愉快的清理缓存"}],["meta",{"property":"og:description","content":"站点缓存着实头痛，那么~重启吧 网站做了站点缓存，测试的时候修改数据后需要重启站点来清楚缓存 如何无需登陆服务器又不用改代码就可以清理换网站上的缓存呢？ 用重启iis怎么样~ 能重启IIS，自然也能干其他的 实现步骤 连接到远程主机 在远程主机一个创建一个包含iisreset命令(+移除计划任务)的脚本 给远程主机添加一项过期的计划任务 立即执行计划任..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-28T11:15:42.000Z"}],["meta",{"property":"article:tag","content":"脚本"}],["meta",{"property":"article:published_time","content":"2017-06-04T02:08:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-28T11:15:42.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"使用批处理脚本愉快的清理缓存\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2017-06-04T02:08:00.000Z\\",\\"dateModified\\":\\"2024-10-28T11:15:42.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"易墨\\",\\"url\\":\\"https://www.yimo.link\\"}]}"]]},"headers":[{"level":2,"title":"站点缓存着实头痛，那么~重启吧","slug":"站点缓存着实头痛-那么-重启吧","link":"#站点缓存着实头痛-那么-重启吧","children":[]},{"level":2,"title":"实现步骤","slug":"实现步骤","link":"#实现步骤","children":[]},{"level":2,"title":"完整批处理脚本- 重启iis.bat","slug":"完整批处理脚本-重启iis-bat","link":"#完整批处理脚本-重启iis-bat","children":[]},{"level":2,"title":"第二次修改","slug":"第二次修改","link":"#第二次修改","children":[]},{"level":2,"title":"关于脚本中的几个关键点","slug":"关于脚本中的几个关键点","link":"#关于脚本中的几个关键点","children":[]},{"level":2,"title":"参考文章","slug":"参考文章","link":"#参考文章","children":[]}],"git":{"createdTime":1730114142000,"updatedTime":1730114142000,"contributors":[{"name":"yimo","email":"yimo@wikiglobal.com","commits":1}]},"readingTime":{"minutes":4.19,"words":1258},"filePathRelative":"posts/developer/use_handle_batch_processing_script_cheerful_clear_cache.md","localizedDate":"2017年6月4日","excerpt":"<h2>站点缓存着实头痛，那么~重启吧</h2>\\n<blockquote>\\n<p>网站做了站点缓存，测试的时候修改数据后需要重启站点来清楚缓存</p>\\n</blockquote>\\n<blockquote>\\n<p>如何无需登陆服务器又不用改代码就可以清理换网站上的缓存呢？</p>\\n</blockquote>\\n<blockquote>\\n<p>用重启iis怎么样~</p>\\n</blockquote>\\n<blockquote>\\n<p>能重启IIS，自然也能干其他的</p>\\n</blockquote>\\n<!--more-->\\n<h2>实现步骤</h2>\\n<ol start=\\"0\\">\\n<li>\\n<p>连接到远程主机</p>\\n</li>\\n<li>\\n<p>在远程主机一个创建一个包含iisreset命令(+移除计划任务)的脚本</p>\\n</li>\\n<li>\\n<p>给远程主机添加一项过期的计划任务</p>\\n</li>\\n<li>\\n<p>立即执行计划任务</p>\\n</li>\\n</ol>","autoDesc":true}');export{r as comp,o as data};
