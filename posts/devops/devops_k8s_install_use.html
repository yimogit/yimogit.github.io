<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://www.yimo.link/posts/devops/devops_k8s_install_use.html"><meta property="og:site_name" content="æ˜“å¢¨ç½‘"><meta property="og:title" content="ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„ K8S è½åœ°å®è·µç»éªŒ"><meta property="og:description" content="å‰è¨€ k8s å³ Kubernetesï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¼•æ“ï¼Œç”¨æ¥å¯¹å®¹å™¨åŒ–åº”ç”¨è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²ã€ æ‰©ç¼©å’Œç®¡ç† æœ¬ç¯‡æ–‡ç« å°†åˆ†äº« k8s v1.18.8 çš„å®‰è£…ï¼Œä»¥åŠå…¶é¢æ¿ï¼Œç›‘æ§ï¼Œéƒ¨ç½²æœåŠ¡ï¼Œä½¿ç”¨Ingress-Ningxè¿›è¡Œè´Ÿè½½å‡è¡¡çš„å®è·µ å› ä¸ºå…¬å¸ç”¨çš„è¿™ä¸ªè€ç‰ˆæœ¬ï¼Œå¹¶ä¸”åé¢è¦è´Ÿè´£æ­å»ºï¼Œæ‹…å¿ƒæ— æ³•å¤åˆ»ï¼Œè¶æ­¤å‘¨æœ«ï¼Œå®è·µä¸€äºŒï¼Œç¡®è®¤å¯è¡Œï¼Œé‚ä¸å›åˆ†äº«ã€‚ è™šæ‹Ÿæœºå‡†å¤‡ å®¿..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-10-28T11:15:42.000Z"><meta property="article:tag" content="devops"><meta property="article:tag" content="k8s"><meta property="article:published_time" content="2023-12-26T08:38:00.000Z"><meta property="article:modified_time" content="2024-10-28T11:15:42.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„ K8S è½åœ°å®è·µç»éªŒ","image":[""],"datePublished":"2023-12-26T08:38:00.000Z","dateModified":"2024-10-28T11:15:42.000Z","author":[{"@type":"Person","name":"æ˜“å¢¨","url":"https://www.yimo.link"}]}</script><link rel="icon" href="/favicon.ico"><title>ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„ K8S è½åœ°å®è·µç»éªŒ | æ˜“å¢¨ç½‘</title><meta name="description" content="å‰è¨€ k8s å³ Kubernetesï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¼•æ“ï¼Œç”¨æ¥å¯¹å®¹å™¨åŒ–åº”ç”¨è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²ã€ æ‰©ç¼©å’Œç®¡ç† æœ¬ç¯‡æ–‡ç« å°†åˆ†äº« k8s v1.18.8 çš„å®‰è£…ï¼Œä»¥åŠå…¶é¢æ¿ï¼Œç›‘æ§ï¼Œéƒ¨ç½²æœåŠ¡ï¼Œä½¿ç”¨Ingress-Ningxè¿›è¡Œè´Ÿè½½å‡è¡¡çš„å®è·µ å› ä¸ºå…¬å¸ç”¨çš„è¿™ä¸ªè€ç‰ˆæœ¬ï¼Œå¹¶ä¸”åé¢è¦è´Ÿè´£æ­å»ºï¼Œæ‹…å¿ƒæ— æ³•å¤åˆ»ï¼Œè¶æ­¤å‘¨æœ«ï¼Œå®è·µä¸€äºŒï¼Œç¡®è®¤å¯è¡Œï¼Œé‚ä¸å›åˆ†äº«ã€‚ è™šæ‹Ÿæœºå‡†å¤‡ å®¿...">
    <link rel="preload" href="/assets/style-D1743K4H.css" as="style"><link rel="stylesheet" href="/assets/style-D1743K4H.css">
    <link rel="modulepreload" href="/assets/app-BJhRIsgW.js"><link rel="modulepreload" href="/assets/devops_k8s_install_use.html-biAkdNjG.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-1JRB42Xd.js" as="script"><link rel="prefetch" href="/assets/intro.html-C-ZDq8Bw.js" as="script"><link rel="prefetch" href="/assets/index.html-CdzV1JGJ.js" as="script"><link rel="prefetch" href="/assets/disable.html-nLB_PZyD.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-_Nlv5EGU.js" as="script"><link rel="prefetch" href="/assets/layout.html-nQl9PHjX.js" as="script"><link rel="prefetch" href="/assets/markdown.html-CVuES-N7.js" as="script"><link rel="prefetch" href="/assets/page.html-CuHIR8-6.js" as="script"><link rel="prefetch" href="/assets/index.html-CDJGW6cP.js" as="script"><link rel="prefetch" href="/assets/index.html-sY3hU3ya.js" as="script"><link rel="prefetch" href="/assets/zhontai_admin_core_book_01.html-CoZGXrL1.js" as="script"><link rel="prefetch" href="/assets/zhontai_admin_core_book_02.html-CZUYODHk.js" as="script"><link rel="prefetch" href="/assets/zhontai_admin_core_book_03.html-Dt8ekGa-.js" as="script"><link rel="prefetch" href="/assets/zhontai_admin_core_book_04.html-CfslmWYW.js" as="script"><link rel="prefetch" href="/assets/zhontai_admin_core_module_dev_gencode.html-BRCPANGD.js" as="script"><link rel="prefetch" href="/assets/zhontai_admin_core_module_dev_use_toproject.html-P5kQEYOT.js" as="script"><link rel="prefetch" href="/assets/index.html-Co27LqhE.js" as="script"><link rel="prefetch" href="/assets/c__operation_operator_operator_easy_use_test.html-BNvtQQS9.js" as="script"><link rel="prefetch" href="/assets/csharp_eval.html-CK9CNhjr.js" as="script"><link rel="prefetch" href="/assets/daily_exploit_a_few_in_common_use_cross_domain_handle_way.html-BbgONiqj.js" as="script"><link rel="prefetch" href="/assets/db_data_derive_tool_share.html-BY9Np3h-.js" as="script"><link rel="prefetch" href="/assets/git_common_commands.html-CeiiO0oa.js" as="script"><link rel="prefetch" href="/assets/k8s_certificate_expire_handle.html-C-6ztJ3R.js" as="script"><link rel="prefetch" href="/assets/linux_study_record01.html-CKnoofvt.js" as="script"><link rel="prefetch" href="/assets/message_queue_study_records.html-Du6BVgoo.js" as="script"><link rel="prefetch" href="/assets/mqdemo_msmq.html-BraXFvsg.js" as="script"><link rel="prefetch" href="/assets/nodejs_in_common_use_code_fragment.html-ejwZnOFl.js" as="script"><link rel="prefetch" href="/assets/nopiexcelimport.html-C7YUQnO8.js" as="script"><link rel="prefetch" href="/assets/part_sms_price_preview.html-Cebne_Ma.js" as="script"><link rel="prefetch" href="/assets/pass_script_download_go_in_common_use_be_related_to.html-C6H-RNjZ.js" as="script"><link rel="prefetch" href="/assets/plug_in_programming_realize_a_portion_chestnut_roasted_chestnuts.html-e4q-15o3.js" as="script"><link rel="prefetch" href="/assets/python_build_android_apk.html-C8Tv66wp.js" as="script"><link rel="prefetch" href="/assets/react_initstep.html-B7CfMbAd.js" as="script"><link rel="prefetch" href="/assets/scale_one_another_convert_study_records.html-D8QymIPr.js" as="script"><link rel="prefetch" href="/assets/service_item_service_item_git_stash_auto_automate_script.html-Cvh_Xp2w.js" as="script"><link rel="prefetch" href="/assets/software_recommend_spacesniffer.html-CjyrVxwd.js" as="script"><link rel="prefetch" href="/assets/travis_ci_operation_puppeteer.html-D8T9D1df.js" as="script"><link rel="prefetch" href="/assets/use_handle_batch_processing_script_cheerful_clear_cache.html-B8uLt151.js" as="script"><link rel="prefetch" href="/assets/use_tts_ffmpeg_auto_generate_video.html-BKG61zAw.js" as="script"><link rel="prefetch" href="/assets/wechat_native_payment_scan_the_code_payment_commercial_owner_disposition.html-woRLVyi1.js" as="script"><link rel="prefetch" href="/assets/windows_go_exploit_environment_disposition_professional_disposition.html-BvYTJIwD.js" as="script"><link rel="prefetch" href="/assets/winform_copy_document_appoint_catalogue.html-lC5zCCVt.js" as="script"><link rel="prefetch" href="/assets/winform_manufacture_tool_craftsmanship.html-BynD2VN6.js" as="script"><link rel="prefetch" href="/assets/with_regard_to_use_uniapp_android_offline_pack_look_out_item_matters_needing_attention.html-Ba25uWfk.js" as="script"><link rel="prefetch" href="/assets/index.html-DDf76h_e.js" as="script"><link rel="prefetch" href="/assets/devops_apollo_install.html-CopANvGj.js" as="script"><link rel="prefetch" href="/assets/devops_dns_dnserver_install_use.html-DLVlK31s.js" as="script"><link rel="prefetch" href="/assets/devops_docker24_composev2_install.html-BicBWG6u.js" as="script"><link rel="prefetch" href="/assets/devops_docker_clickhouse_install.html-bLgNnE4z.js" as="script"><link rel="prefetch" href="/assets/devops_docker_elk_install_nginx_config.html-BzLfVXHF.js" as="script"><link rel="prefetch" href="/assets/devops_docker_mysql_mongo.html-CekZZ9-d.js" as="script"><link rel="prefetch" href="/assets/devops_docker_redis_cluster_install.html-B2b8JTN2.js" as="script"><link rel="prefetch" href="/assets/devops_docker_to_nexus_deploy_k8s_use.html-9HKxr-BP.js" as="script"><link rel="prefetch" href="/assets/devops_hyperv_centos_install.html-5d2R_2Xq.js" as="script"><link rel="prefetch" href="/assets/devops_jumpserver_install_use.html-BN6kvTQ6.js" as="script"><link rel="prefetch" href="/assets/devops_nexus3_nuget_docker_install_use.html-CvBrhZWr.js" as="script"><link rel="prefetch" href="/assets/devops_prometheus_grafana_install_use_db_site_monitor.html-CCsCzVjq.js" as="script"><link rel="prefetch" href="/assets/index.html-v3hFNIZZ.js" as="script"><link rel="prefetch" href="/assets/docker_build_node_vue_01.html-C0meNhqC.js" as="script"><link rel="prefetch" href="/assets/docker_compose_yml_share.html-DR7pdkVB.js" as="script"><link rel="prefetch" href="/assets/docker_docker_compose_fast_install_easy_use.html-D01O70jr.js" as="script"><link rel="prefetch" href="/assets/docker_jenkins_use.html-9fTiUatd.js" as="script"><link rel="prefetch" href="/assets/docker_publish_netcore_website_scattered_records.html-BH2_t28E.js" as="script"><link rel="prefetch" href="/assets/jenkins_shell_script_operation_docker_limits_of_authority_report_an_error_work_out.html-Bu_tCemA.js" as="script"><link rel="prefetch" href="/assets/traefik_v1_unite_docker_compose_fast_install_use.html-CIIOwgNa.js" as="script"><link rel="prefetch" href="/assets/index.html-BNLxq7Xw.js" as="script"><link rel="prefetch" href="/assets/asp_net_core2.1_append_middle_middleware_extend_swashbuckle_aspnetcore3.0_support_easy_document_interview_limits_of_authority_controls.html-tJiNy6FP.js" as="script"><link rel="prefetch" href="/assets/asp_net_core_backstage_system_log_in_fast_construct.html-MFMC0JJa.js" as="script"><link rel="prefetch" href="/assets/asp_net_core_encapsulation_layui_module_give_an_example_share.html-C-orJs4I.js" as="script"><link rel="prefetch" href="/assets/asp_net_core_limits_of_authority_module_fast_construct.html-BQdQYtHi.js" as="script"><link rel="prefetch" href="/assets/asp_net_core_merge_compress_assets_document_trigger_study_a_trip_to.html-bOqglHC_.js" as="script"><link rel="prefetch" href="/assets/asp_net_core_use_mysql_records.html-Btw1vw1k.js" as="script"><link rel="prefetch" href="/assets/asp_net_core_use_swashbuckle_aspnetcore_swagger_generate_port_document.html-Dx31lNfM.js" as="script"><link rel="prefetch" href="/assets/docker_dotnet_nuget_error_docker_custom_build.html-CW7wlQd2.js" as="script"><link rel="prefetch" href="/assets/docker_publish_netcore_website_scattered_records.html-CB2Yt1uU.js" as="script"><link rel="prefetch" href="/assets/dotnet_additional_process_debugging_bug.html-apPF2aJl.js" as="script"><link rel="prefetch" href="/assets/dotnet_use_selenium_carry_out_auto_automate_quest.html-Btle0RMT.js" as="script"><link rel="prefetch" href="/assets/dotnet_warp_nssm_deploy_net_core_item_windows_service.html-CIX8lXjE.js" as="script"><link rel="prefetch" href="/assets/in_common_use_cmd_code_fragment_net_core_pack_script_share.html-Pjz_vWGp.js" as="script"><link rel="prefetch" href="/assets/mvc_website_transfer_net_core_records.html-BKlH6FJu.js" as="script"><link rel="prefetch" href="/assets/net_core2.1_use_dynamic_type_report_an_error.html-D3q9ACMN.js" as="script"><link rel="prefetch" href="/assets/net_core_selenium_github_travis_ci_sitehistory.html-BDR6YP1f.js" as="script"><link rel="prefetch" href="/assets/netcore8_swagger_group_namespace_show.html-M70qD97j.js" as="script"><link rel="prefetch" href="/assets/netcore_01.html-LzYOryOQ.js" as="script"><link rel="prefetch" href="/assets/swashbuckle_aspnetcore3.0_twice_encapsulation_use.html-DJy0Q3op.js" as="script"><link rel="prefetch" href="/assets/ubuntu_view_unload_software_unload_net_core_sdk_method.html-DmlYYdEi.js" as="script"><link rel="prefetch" href="/assets/index.html-DreUvY-G.js" as="script"><link rel="prefetch" href="/assets/national_day_holiday_note_complete_perfect.html-n32T56h-.js" as="script"><link rel="prefetch" href="/assets/single_routine_2023_sum_up_look_for.html-Ch9J3MpP.js" as="script"><link rel="prefetch" href="/assets/index.html-CarVLPwZ.js" as="script"><link rel="prefetch" href="/assets/customize_definition_custom_roll_scroll_bar_pattern_layui_v1.html-DpzlcA7t.js" as="script"><link rel="prefetch" href="/assets/devops_nginx_install_use.html-Dy-Ghx3z.js" as="script"><link rel="prefetch" href="/assets/front_and_rear_useful_come_in_handy_nginx_daily_use_exp_replenishment.html-Dqz-EObe.js" as="script"><link rel="prefetch" href="/assets/layui_use_autocomplete_js.html-Jdpq9ehv.js" as="script"><link rel="prefetch" href="/assets/metools_remark.html-BQ6DT-3J.js" as="script"><link rel="prefetch" href="/assets/share_vue_item_with_regard_to_api_request_some_realize_item_frame.html-Ce5iAnc6.js" as="script"><link rel="prefetch" href="/assets/taghelper_layui_encapsulation_module_radio_single_choice_checkbox_radio_box.html-CQRbuFeg.js" as="script"><link rel="prefetch" href="/assets/vue_item_append_pwa_work_out_publish_refresh_report_an_error_problem.html-FeEnhbvz.js" as="script"><link rel="prefetch" href="/assets/vue_item_practice_append_axios_encapsulation_api_request.html-BVQSf4-G.js" as="script"><link rel="prefetch" href="/assets/vue_item_practice_append_express_mockjs_proceed_data_simulate.html-D5dB1DYl.js" as="script"><link rel="prefetch" href="/assets/vue_item_practice_front_and_rear_separate_with_regard_to_limits_of_authority_train_of_thought.html-CBreWoS9.js" as="script"><link rel="prefetch" href="/assets/vue_item_with_regard_to_axios_easy_use.html-rUxGTsdR.js" as="script"><link rel="prefetch" href="/assets/vue_mescroll_vscrollfull.html-Cv0wbVOx.js" as="script"><link rel="prefetch" href="/assets/vue_practice_records.html-ZfZQZXZM.js" as="script"><link rel="prefetch" href="/assets/vue_router_history_mode_publish_disposition.html-B9NFtjJ3.js" as="script"><link rel="prefetch" href="/assets/webdev_chii.html-CCAXe0WG.js" as="script"><link rel="prefetch" href="/assets/404.html-DrusccQ9.js" as="script"><link rel="prefetch" href="/assets/index.html-DXoUASTI.js" as="script"><link rel="prefetch" href="/assets/index.html-Bn7w4EOc.js" as="script"><link rel="prefetch" href="/assets/index.html-D5KhUyoe.js" as="script"><link rel="prefetch" href="/assets/index.html-BJFQX8Wn.js" as="script"><link rel="prefetch" href="/assets/index.html-h2FSslzr.js" as="script"><link rel="prefetch" href="/assets/index.html-bMD15Hcg.js" as="script"><link rel="prefetch" href="/assets/index.html-Db1vGCq3.js" as="script"><link rel="prefetch" href="/assets/index.html-BoQxM3KY.js" as="script"><link rel="prefetch" href="/assets/index.html-mw6JLC7l.js" as="script"><link rel="prefetch" href="/assets/index.html-D7YOaRzh.js" as="script"><link rel="prefetch" href="/assets/index.html-DPTwWYRz.js" as="script"><link rel="prefetch" href="/assets/index.html-ny2z-yDS.js" as="script"><link rel="prefetch" href="/assets/index.html-NGmJKqV6.js" as="script"><link rel="prefetch" href="/assets/index.html-TTZS1LZQ.js" as="script"><link rel="prefetch" href="/assets/index.html-mV5bh4Jg.js" as="script"><link rel="prefetch" href="/assets/index.html-B7GbDewX.js" as="script"><link rel="prefetch" href="/assets/index.html-D6z6kHXA.js" as="script"><link rel="prefetch" href="/assets/index.html-D4B6lvyV.js" as="script"><link rel="prefetch" href="/assets/index.html-B6vRnt2f.js" as="script"><link rel="prefetch" href="/assets/index.html-RMs8a4wg.js" as="script"><link rel="prefetch" href="/assets/index.html-DZmkQtHB.js" as="script"><link rel="prefetch" href="/assets/index.html-BeQN0Z-n.js" as="script"><link rel="prefetch" href="/assets/index.html-D_LdpNH9.js" as="script"><link rel="prefetch" href="/assets/index.html-ZdIpzaHu.js" as="script"><link rel="prefetch" href="/assets/index.html-BIAKdwsE.js" as="script"><link rel="prefetch" href="/assets/index.html-D5CZVT4B.js" as="script"><link rel="prefetch" href="/assets/index.html-Dff3fiqD.js" as="script"><link rel="prefetch" href="/assets/index.html-NFrfwXE1.js" as="script"><link rel="prefetch" href="/assets/index.html-CV5c7UX6.js" as="script"><link rel="prefetch" href="/assets/index.html-Dnw4M6ne.js" as="script"><link rel="prefetch" href="/assets/index.html-BSwaa22C.js" as="script"><link rel="prefetch" href="/assets/index.html-CMySzLp-.js" as="script"><link rel="prefetch" href="/assets/index.html-DPCFQYUk.js" as="script"><link rel="prefetch" href="/assets/index.html-DKllXlaU.js" as="script"><link rel="prefetch" href="/assets/index.html-Bki_KSlk.js" as="script"><link rel="prefetch" href="/assets/index.html-dFoPZd9F.js" as="script"><link rel="prefetch" href="/assets/index.html-ZIGAnapo.js" as="script"><link rel="prefetch" href="/assets/index.html-B9OpQClW.js" as="script"><link rel="prefetch" href="/assets/index.html-Cc23ABc_.js" as="script"><link rel="prefetch" href="/assets/index.html-rk4UL7TV.js" as="script"><link rel="prefetch" href="/assets/index.html--b8-6-qD.js" as="script"><link rel="prefetch" href="/assets/index.html-DvhnsKJo.js" as="script"><link rel="prefetch" href="/assets/index.html-BytFJxXZ.js" as="script"><link rel="prefetch" href="/assets/index.html-fHN2IGsT.js" as="script"><link rel="prefetch" href="/assets/index.html-50rczdtU.js" as="script"><link rel="prefetch" href="/assets/index.html-G3ZQudMZ.js" as="script"><link rel="prefetch" href="/assets/index.html-D_CKhMNC.js" as="script"><link rel="prefetch" href="/assets/index.html-CAhqDmO_.js" as="script"><link rel="prefetch" href="/assets/index.html-BmVWa7vZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DiwyrEbO.js" as="script"><link rel="prefetch" href="/assets/index.html-BfIMpSbO.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-BILvUjC4.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-BqKyTeK3.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">æ˜“å¢¨ç½‘</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="æ˜“å¢¨ç½‘"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->æ˜“å¢¨ç½‘<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/article/" aria-label="æ–‡ç« "><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><!--]-->æ–‡ç« <!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/timeline/" aria-label="æ—¶é—´è½´"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-timeline" style=""></span><!--]-->æ—¶é—´è½´<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="åˆé›†"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-newspaper" style=""></span>åˆé›†<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/admincore/" aria-label="ä¸­å°é¡¹ç›® Admin.Core"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->ä¸­å°é¡¹ç›® Admin.Core<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/posts/devops/" aria-label="å¾®æœåŠ¡é¡¹ç›® DevOps"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->å¾®æœåŠ¡é¡¹ç›® DevOps<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/developer/" aria-label="æ—¥å¸¸å¼€å‘"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->æ—¥å¸¸å¼€å‘<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/web/" aria-label="å‰ç«¯å¼€å‘"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->å‰ç«¯å¼€å‘<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/docker/" aria-label="Docker"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/dotnetcore/" aria-label="DotNetCore"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->DotNetCore<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ä¸€äº›è½®å­"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-sliders" style=""></span>ä¸€äº›è½®å­<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://coverview.yimo.link" aria-label="CoverView å°é¢ç”Ÿæˆå™¨" rel="noopener noreferrer" target="_blank"><!---->CoverView å°é¢ç”Ÿæˆå™¨<!----></a></li><li class="vp-dropdown-item"><a class="auto-link external-link" href="https://github.com/yimogit/metools-plugin" aria-label="MeTools æ—¥å¸¸å·¥å…·é›†" rel="noopener noreferrer" target="_blank"><!---->MeTools æ—¥å¸¸å·¥å…·é›†<!----></a></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ä¸€äº›å°è¯•</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/Emo.Dev" aria-label="ä»£ç ç”Ÿæˆå™¨" rel="noopener noreferrer" target="_blank"><!---->ä»£ç ç”Ÿæˆå™¨<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/ExcelDocTxtTemplateReplace" aria-label="æ¨¡æ¿æ›¿æ¢å·¥å…·" rel="noopener noreferrer" target="_blank"><!---->æ¨¡æ¿æ›¿æ¢å·¥å…·<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/YimoCustomizedSign" aria-label="ä¸€ä¸ªè‡ªåŠ¨åŒ–ç­¾åˆ°ç¨‹åº" rel="noopener noreferrer" target="_blank"><!---->ä¸€ä¸ªè‡ªåŠ¨åŒ–ç­¾åˆ°ç¨‹åº<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/vue-template" aria-label="vue æ¨¡æ¿å°è£…" rel="noopener noreferrer" target="_blank"><!---->vue æ¨¡æ¿å°è£…<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/vue-layui" aria-label="vue-layui å°è£…" rel="noopener noreferrer" target="_blank"><!---->vue-layui å°è£…<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/me-admin-template" aria-label="vue-ElementUI æ¨¡æ¿å°è£…" rel="noopener noreferrer" target="_blank"><!---->vue-ElementUI æ¨¡æ¿å°è£…<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/me-admin-sdk" aria-label="vue-ElementUI npmåŒ…å°è£…" rel="noopener noreferrer" target="_blank"><!---->vue-ElementUI npmåŒ…å°è£…<!----></a></li><li class="vp-dropdown-subitem"><a class="auto-link external-link" href="https://github.com/yimogit/vue-project-summary" aria-label="vue é¡¹ç›®ç»éªŒæ€»ç»“" rel="noopener noreferrer" target="_blank"><!---->vue é¡¹ç›®ç»éªŒæ€»ç»“<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/yimogit/yimogit.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/" aria-label="å¾®æœåŠ¡é¡¹ç›® DevOps"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><!--]-->å¾®æœåŠ¡é¡¹ç›® DevOps<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_hyperv_centos_install.html" aria-label="Hyper-V å®‰è£… CentOS 8.5"><!---->Hyper-V å®‰è£… CentOS 8.5<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_docker24_composev2_install.html" aria-label="Docker V24 åŠ Docker Compose V2 çš„å®‰è£…åŠä½¿ç”¨"><!---->Docker V24 åŠ Docker Compose V2 çš„å®‰è£…åŠä½¿ç”¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_docker_mysql_mongo.html" aria-label="Docker Compose V2 å®‰è£…å¸¸ç”¨æ•°æ®åº“MySQL+Mongo"><!---->Docker Compose V2 å®‰è£…å¸¸ç”¨æ•°æ®åº“MySQL+Mongo<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_docker_clickhouse_install.html" aria-label="Docker Compose V2 å®‰è£… ClickHouse v20.6.8.5 ç»éªŒåˆ†äº«"><!---->Docker Compose V2 å®‰è£… ClickHouse v20.6.8.5 ç»éªŒåˆ†äº«<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_docker_redis_cluster_install.html" aria-label="Docker å®‰è£… Redis å•æœº&amp;é›†ç¾¤æ€»ç»“"><!---->Docker å®‰è£… Redis å•æœº&amp;é›†ç¾¤æ€»ç»“<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_apollo_install.html" aria-label="Apollo é…ç½®ä¸­å¿ƒçš„éƒ¨ç½²ä¸ä½¿ç”¨ç»éªŒ"><!---->Apollo é…ç½®ä¸­å¿ƒçš„éƒ¨ç½²ä¸ä½¿ç”¨ç»éªŒ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_dns_dnserver_install_use.html" aria-label="ä¸€ä¸ªåŸºäº.NET7çš„å¼€æºDNSæœåŠ¡ DnsServer çš„éƒ¨ç½²ä½¿ç”¨ç»éªŒåˆ†äº«"><!---->ä¸€ä¸ªåŸºäº.NET7çš„å¼€æºDNSæœåŠ¡ DnsServer çš„éƒ¨ç½²ä½¿ç”¨ç»éªŒåˆ†äº«<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_nexus3_nuget_docker_install_use.html" aria-label="ä¸€ç¯‡é€‚åˆèººæ”¶è—å¤¹çš„ Nexus3 æ­å»º NuGet&amp;Docker ç§æœ‰åº“çš„å®‰è£…ä½¿ç”¨æ€»ç»“"><!---->ä¸€ç¯‡é€‚åˆèººæ”¶è—å¤¹çš„ Nexus3 æ­å»º NuGet&amp;Docker ç§æœ‰åº“çš„å®‰è£…ä½¿ç”¨æ€»ç»“<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_jumpserver_install_use.html" aria-label="æå‡è¿ç»´æ•ˆç‡ï¼šè½»æ¾æŒæ¡JumpServerå®‰è£…å’Œä½¿ç”¨æŠ€å·§"><!---->æå‡è¿ç»´æ•ˆç‡ï¼šè½»æ¾æŒæ¡JumpServerå®‰è£…å’Œä½¿ç”¨æŠ€å·§<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_prometheus_grafana_install_use_db_site_monitor.html" aria-label="Prometheus+Grafana ç›‘æ§å¹³å°å®è·µ-æ­å»º&amp;å¸¸ç”¨æœåŠ¡ç›‘æ§&amp;å‘Šè­¦"><!---->Prometheus+Grafana ç›‘æ§å¹³å°å®è·µ-æ­å»º&amp;å¸¸ç”¨æœåŠ¡ç›‘æ§&amp;å‘Šè­¦<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/posts/devops/devops_k8s_install_use.html" aria-label="ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„ K8S è½åœ°å®è·µç»éªŒ"><!---->ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„ K8S è½åœ°å®è·µç»éªŒ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_docker_to_nexus_deploy_k8s_use.html" aria-label="æ„å»º dotnet&amp;vue åº”ç”¨é•œåƒ-&gt;æ¨é€åˆ° Nexus ä»“åº“-&gt;éƒ¨ç½²ä¸º k8s æœåŠ¡å®è·µ"><!---->æ„å»º dotnet&amp;vue åº”ç”¨é•œåƒ-&gt;æ¨é€åˆ° Nexus ä»“åº“-&gt;éƒ¨ç½²ä¸º k8s æœåŠ¡å®è·µ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/devops/devops_docker_elk_install_nginx_config.html" aria-label="ä½¿ç”¨ Docker Compose V2 å¿«é€Ÿæ­å»ºæ—¥å¿—åˆ†æå¹³å° ELK (Elasticsearchã€Logstash å’Œ Kibana)"><!---->ä½¿ç”¨ Docker Compose V2 å¿«é€Ÿæ­å»ºæ—¥å¿—åˆ†æå¹³å° ELK (Elasticsearchã€Logstash å’Œ Kibana)<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„ K8S è½åœ°å®è·µç»éªŒ</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.yimo.link" target="_blank" rel="noopener noreferrer">æ˜“å¢¨</a></span><span property="author" content="æ˜“å¢¨"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023å¹´12æœˆ26æ—¥</span><meta property="datePublished" content="2023-12-26T08:38:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 15 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT15M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color2 clickable" role="navigation">DevOps</span><!--]--><meta property="articleSection" content="DevOps"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color7 clickable" role="navigation">devops</span><span class="page-tag-item color5 clickable" role="navigation">k8s</span><!--]--><meta property="keywords" content="devops,k8s"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å‰è¨€">å‰è¨€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#è™šæ‹Ÿæœºå‡†å¤‡">è™šæ‹Ÿæœºå‡†å¤‡</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#centos8-5-è®¾ç½®å›ºå®š-ip">CentOS8.5 è®¾ç½®å›ºå®š IP</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#centos8-5-è”ç½‘æ£€æŸ¥">CentOS8.5 è”ç½‘æ£€æŸ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#centos8-5-è®¾ç½®ä¸»æœºå">CentOS8.5 è®¾ç½®ä¸»æœºå</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š-mac-åœ°å€çš„å”¯ä¸€æ€§">ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€çš„å”¯ä¸€æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¡®ä¿-product-uuid-çš„å”¯ä¸€æ€§">ç¡®ä¿ product_uuid çš„å”¯ä¸€æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¡®ä¿-machine-id-çš„å”¯ä¸€æ€§">ç¡®ä¿ Machine ID çš„å”¯ä¸€æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨">æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®‰è£…-k8s-v1-18-8">å®‰è£… K8S v1.18.8</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#èŠ‚ç‚¹åˆå§‹åŒ–">èŠ‚ç‚¹åˆå§‹åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰è£…kubeadm-kubelet-kubectl">å®‰è£…kubeadm&amp;kubelet&amp;kubectl</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰è£…å®¹å™¨">å®‰è£…å®¹å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è®¾ç½®èŠ‚ç‚¹ç½‘ç»œçš„åˆ«å">è®¾ç½®èŠ‚ç‚¹ç½‘ç»œçš„åˆ«å</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åˆå§‹åŒ–é›†ç¾¤">åˆå§‹åŒ–é›†ç¾¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰è£…ç½‘ç»œæ’ä»¶-flannel">å®‰è£…ç½‘ç»œæ’ä»¶ flannel</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#workerèŠ‚ç‚¹é…ç½®">workerèŠ‚ç‚¹é…ç½®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®‰è£…-dashboard-v2-0-3">å®‰è£… Dashboard v2.0.3</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®‰è£…-metrics-server-v0-3-7">å®‰è£… Metrics Server v0.3.7</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®‰è£…-helm-v3-13-1">å®‰è£… Helm v3.13.1</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä½¿ç”¨-k8s-é›†ç¾¤éƒ¨ç½²æœåŠ¡">ä½¿ç”¨ K8S é›†ç¾¤éƒ¨ç½²æœåŠ¡</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#éƒ¨ç½²ä¸€ä¸ª-nginx-æœåŠ¡">éƒ¨ç½²ä¸€ä¸ª nginx æœåŠ¡</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ä½¿ç”¨-ingress-nginx-v3-41è¿›è¡ŒæœåŠ¡è´Ÿè½½">ä½¿ç”¨ Ingress-Nginx v3.41è¿›è¡ŒæœåŠ¡è´Ÿè½½</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‡†å¤‡">å‡†å¤‡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®‰è£…">å®‰è£…</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä½¿ç”¨">ä½¿ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#è¸©å‘è®°å½•">è¸©å‘è®°å½•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ç›¸å…³æ–‡æ¡£">ç›¸å…³æ–‡æ¡£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#åè¯­">åè¯­</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h2 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€"><span>å‰è¨€</span></a></h2><blockquote><p>k8s å³ Kubernetesï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å¼•æ“ï¼Œç”¨æ¥å¯¹å®¹å™¨åŒ–åº”ç”¨è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²ã€ æ‰©ç¼©å’Œç®¡ç†<br> æœ¬ç¯‡æ–‡ç« å°†åˆ†äº« k8s v1.18.8 çš„å®‰è£…ï¼Œä»¥åŠå…¶é¢æ¿ï¼Œç›‘æ§ï¼Œéƒ¨ç½²æœåŠ¡ï¼Œä½¿ç”¨Ingress-Ningxè¿›è¡Œè´Ÿè½½å‡è¡¡çš„å®è·µ<br> å› ä¸ºå…¬å¸ç”¨çš„è¿™ä¸ªè€ç‰ˆæœ¬ï¼Œå¹¶ä¸”åé¢è¦è´Ÿè´£æ­å»ºï¼Œæ‹…å¿ƒæ— æ³•å¤åˆ»ï¼Œè¶æ­¤å‘¨æœ«ï¼Œå®è·µä¸€äºŒï¼Œç¡®è®¤å¯è¡Œï¼Œé‚ä¸å›åˆ†äº«ã€‚</p></blockquote><h2 id="è™šæ‹Ÿæœºå‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿæœºå‡†å¤‡"><span>è™šæ‹Ÿæœºå‡†å¤‡</span></a></h2><ul><li>å®¿ä¸»æœºï¼šWindows10</li><li>è™šæ‹Ÿæœºå·¥å…·ï¼šHyper-V 10.0.19041.1</li><li>è™šæ‹Ÿæœº Linux ç³»ç»Ÿï¼šCentOS 8.5</li><li>å·²å®‰è£…è½¯ä»¶ï¼šdocker (v2.21.0)åŠ docker compose(24.0.6)</li><li>Hyper-Vè™šæ‹Ÿæœºä¸€è§ˆ</li></ul><figure><img src="/assets/662652-20231224221252676-1766144377-yW_J3zNs.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>IP åŠä¸»æœºå</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>192.168.123.100 master</span></span>
<span class="line"><span>192.168.123.101 worker01</span></span>
<span class="line"><span>192.168.123.102 worker02</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="centos8-5-è®¾ç½®å›ºå®š-ip" tabindex="-1"><a class="header-anchor" href="#centos8-5-è®¾ç½®å›ºå®š-ip"><span>CentOS8.5 è®¾ç½®å›ºå®š IP</span></a></h3><ul><li>è®¾ç½®IPåŠç½‘å…³ï¼š<code>vi /etc/sysconfig/network-scripts/ifcfg-eth0</code></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>TYPE=Ethernet</span></span>
<span class="line"><span>PROXY_METHOD=none</span></span>
<span class="line"><span>BROWSER_ONLY=no</span></span>
<span class="line"><span>DEFROUTE=yes</span></span>
<span class="line"><span>IPV4_FAILURE_FATAL=no</span></span>
<span class="line"><span>IPV6INIT=yes</span></span>
<span class="line"><span>IPV6_AUTOCONF=yes</span></span>
<span class="line"><span>IPV6_DEFROUTE=yes</span></span>
<span class="line"><span>IPV6_FAILURE_FATAL=no</span></span>
<span class="line"><span>NAME=eth0</span></span>
<span class="line"><span>DEVICE=eth0</span></span>
<span class="line"><span>ONBOOT=yes</span></span>
<span class="line"><span>PREFIX=24</span></span>
<span class="line"><span>IPV6_PRIVACY=no</span></span>
<span class="line"><span># è®¾ç½®IPåŠç½‘å…³</span></span>
<span class="line"><span>BOOTPROTO=static</span></span>
<span class="line"><span>IPADDR=192.168.123.100</span></span>
<span class="line"><span>GATEWAY=192.168.123.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="centos8-5-è”ç½‘æ£€æŸ¥" tabindex="-1"><a class="header-anchor" href="#centos8-5-è”ç½‘æ£€æŸ¥"><span>CentOS8.5 è”ç½‘æ£€æŸ¥</span></a></h3><ul><li>é…ç½®å¥½ç½‘ç»œåå…ˆæµ‹è¯• curl æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®ç½‘ç»œ<code> curl ``http://mirrors.aliyun.com</code>ï¼Œå¦‚æœæç¤ºï¼š<code> curl: (6) Could not resolve host: ``mirrors.aliyun.com</code> ï¼Œåˆ™éœ€è¦æ£€æŸ¥dnsè®¾ç½®</li><li><code>cat /etc/resolv.conf</code> é»˜è®¤åº”è¯¥æ˜¯ç½‘å…³çš„åœ°å€ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œä¿®æ”¹ä¸ºå…¶ä»–å…¬å…±dns</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>nameserver 192.168.123.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="centos8-5-è®¾ç½®ä¸»æœºå" tabindex="-1"><a class="header-anchor" href="#centos8-5-è®¾ç½®ä¸»æœºå"><span>CentOS8.5 è®¾ç½®ä¸»æœºå</span></a></h3><ul><li>æŸ¥çœ‹ä¸»æœºä¿¡æ¯ï¼š<code>hostnamectl</code>ï¼Œé€šè¿‡å¯¼å…¥è™šæ‹Ÿæœºåˆ›å»ºçš„ä¸»æœºä¿¡æ¯é™¤äº†macåœ°å€å…¶ä»–åŸºæœ¬éƒ½ä¸€æ ·</li><li>è®¾ç½®ä¸»æœºåï¼š<code>hostnamectl set-hostname ä¸»æœºå</code></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># æŸ¥çœ‹hostname</span></span>
<span class="line"><span>hostnamectl --static</span></span>
<span class="line"><span>#è®¾ç½® hostname å¯¹åº”æœºå™¨è®¾ç½®</span></span>
<span class="line"><span># 192.168.123.100</span></span>
<span class="line"><span>hostnamectl set-hostname master</span></span>
<span class="line"><span># 192.168.123.101</span></span>
<span class="line"><span>hostnamectl set-hostname worker01</span></span>
<span class="line"><span># 192.168.123.102</span></span>
<span class="line"><span>hostnamectl set-hostname worker02</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š-mac-åœ°å€çš„å”¯ä¸€æ€§" tabindex="-1"><a class="header-anchor" href="#ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š-mac-åœ°å€çš„å”¯ä¸€æ€§"><span>ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Š MAC åœ°å€çš„å”¯ä¸€æ€§</span></a></h3><p>å¯ä»¥åœ¨å¤–éƒ¨ä½¿ç”¨ PowerShell æŸ¥çœ‹ Hyper-V è™šæ‹Ÿæœºçš„åœ°å€ï¼Œåœ¨å¯¼å…¥æ—¶é€‰æ‹©æ–°æ³¨å†Œä¼šè‡ªåŠ¨ç”Ÿæˆ Mac åœ°å€ï¼Œæ— éœ€æ›´æ”¹</p><ul><li>centos8.5 æŸ¥çœ‹macåœ°å€ï¼š<code>ip link show dev eth0</code></li></ul><figure><img src="/assets/662652-20231224221252593-915957863-D4Hag4AY.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>å¤–éƒ¨ä½¿ç”¨ PowerShell æŸ¥çœ‹ï¼š<code>(Get-VMNetworkAdapter -VMName &quot;k8s-master&quot;).MacAddress</code></li></ul><figure><img src="/assets/662652-20231224221252584-1526366459-RXNj228d.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="ç¡®ä¿-product-uuid-çš„å”¯ä¸€æ€§" tabindex="-1"><a class="header-anchor" href="#ç¡®ä¿-product-uuid-çš„å”¯ä¸€æ€§"><span>ç¡®ä¿ product_uuid çš„å”¯ä¸€æ€§</span></a></h3><ul><li>æ‰§è¡Œ <code>sudo cat /sys/class/dmi/id/product_uuid</code> æŸ¥çœ‹<code>product_uuid</code> æˆ‘è¿™é‡Œå› ä¸ºéƒ½æ˜¯å¤åˆ¶çš„è™šæ‹Ÿæœºï¼ŒæŸ¥å‡ºæ¥æ˜¯ä¸€æ ·çš„çš„ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹</li></ul><figure><img src="/assets/662652-20231224221252629-1383913254-DxR2MdJB.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ä¿®æ”¹éœ€è¦å…³é—­è™šæ‹Ÿæœºåæ‰§è¡ŒPowerShellè„šæœ¬ ï¼Œ<a href="https://www.cnblogs.com/morang/p/hyper-v-uuid-change-powershell-script.html" target="_blank" rel="noopener noreferrer">æ–‡ç« æ€»ç»“</a></li><li>å¤–éƒ¨æŸ¥çœ‹Hyper-Vè™šæ‹Ÿæœº UUID</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Get-VM &quot;k8s-master&quot; | % { (gwmi -Namespace root\virtualization\v2 -Class msvm_computersystem -Filter (&#39;ElementName=&quot;{0}&quot;&#39; -f $_.Name)).GetRelated(&#39;msvm_virtualsystemsettingdata&#39;) | select BIOSGUID }</span></span>
<span class="line"><span>Get-VM &quot;k8s-worker01&quot; | % { (gwmi -Namespace root\virtualization\v2 -Class msvm_computersystem -Filter (&#39;ElementName=&quot;{0}&quot;&#39; -f $_.Name)).GetRelated(&#39;msvm_virtualsystemsettingdata&#39;) | select BIOSGUID }</span></span>
<span class="line"><span>Get-VM &quot;k8s-worker02&quot; | % { (gwmi -Namespace root\virtualization\v2 -Class msvm_computersystem -Filter (&#39;ElementName=&quot;{0}&quot;&#39; -f $_.Name)).GetRelated(&#39;msvm_virtualsystemsettingdata&#39;) | select BIOSGUID }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>PowerShell ä¿®æ”¹ Hyper-Vè™šæ‹Ÿæœº UUID</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>#è¿™é‡Œå‡è®¾è™šæ‹Ÿæœºçš„VMnameæ˜¯k8s-masterï¼Œè‡ªè¡Œæ›¿æ¢å³å¯</span></span>
<span class="line"><span>$VMname=&quot;k8s-master&quot;</span></span>
<span class="line"><span>$vmx = Get-WmiObject -Namespace root\virtualization\v2 -Class msvm_virtualsystemsettingdata </span></span>
<span class="line"><span>#æ¯æ¬¡æ“ä½œé€‰æ‹©ä¸€å°è™šæ‹Ÿæœº</span></span>
<span class="line"><span>$CurrentSettingsData = $vmx | Where-Object { $_.ElementName -eq $VMname }</span></span>
<span class="line"><span>#æ£€æŸ¥ä¸€ä¸‹è€çš„GUID</span></span>
<span class="line"><span>$CurrentSettingsData.BIOSGUID</span></span>
<span class="line"><span>#ç”Ÿæˆæ–°GUID</span></span>
<span class="line"><span>$GUID = [System.Guid]::NewGuid()</span></span>
<span class="line"><span>#é‡æ–°å†™å…¥GUIDï¼Œæ³¨æ„è¦å¸¦{}ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„ç»†èŠ‚</span></span>
<span class="line"><span>$CurrentSettingsData.BIOSGUID = &quot;{&quot; + $GUID.Guid.ToUpper() + &quot;}&quot; </span></span>
<span class="line"><span>#ç”Ÿæˆä¸€ä¸ªModifySystemSettingsçš„ç©ºå¯¹è±¡</span></span>
<span class="line"><span>$VMMS = Get-WmiObject -Namespace root\virtualization\v2 -Class msvm_virtualsystemmanagementservice</span></span>
<span class="line"><span>$ModifySystemSettingsParams = $VMMS.GetMethodParameters(&#39;ModifySystemSettings&#39;)</span></span>
<span class="line"><span>#é…ç½®è¿™ä¸ªå±æ€§ï¼Œéœ€è¦ç‰¹æ®Šçš„è½¬æ¢æ–¹å¼</span></span>
<span class="line"><span>$ModifySystemSettingsParams.SystemSettings = $CurrentSettingsData.GetText([System.Management.TextFormat]::CimDtd20)</span></span>
<span class="line"><span>#å†™å…¥</span></span>
<span class="line"><span>$VMMS.InvokeMethod(&#39;ModifySystemSettings&#39;, $ModifySystemSettingsParams, $null)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¼€æœºåæŸ¥è¯¢å¯ä»¥çœ‹åˆ°å·²ç»ä¿®æ”¹æˆåŠŸ</li></ul><figure><img src="/assets/662652-20231224221252663-882439839-B4dVaE0s.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="ç¡®ä¿-machine-id-çš„å”¯ä¸€æ€§" tabindex="-1"><a class="header-anchor" href="#ç¡®ä¿-machine-id-çš„å”¯ä¸€æ€§"><span>ç¡®ä¿ Machine ID çš„å”¯ä¸€æ€§</span></a></h3><ul><li>æ‰§è¡Œ <code>/etc/machine-id</code> æˆ–ä½¿ç”¨ hostnamectl å‘ç°æœºå™¨idæ˜¯ä¸€æ ·çš„</li></ul><figure><img src="/assets/662652-20231224221252613-1220781311-CK23yO_S.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>é‡æ–°ç”Ÿæˆäº†æœºå™¨id</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>sudo cp /etc/machine-id /etc/machine-id.backup</span></span>
<span class="line"><span>sudo rm /etc/machine-id</span></span>
<span class="line"><span>sudo systemd-machine-id-setup</span></span>
<span class="line"><span>cat /etc/machine-id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ‰§è¡Œç»“æœ</li></ul><figure><img src="/assets/662652-20231224221252710-478069305-DBPvvcmG.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨" tabindex="-1"><a class="header-anchor" href="#æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨"><span>æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨</span></a></h3><figure><img src="/assets/662652-20231224221252716-805428728-B2-18c-U.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>centos8.5 ä½¿ç”¨ ss æŸ¥è¯¢ç«¯å£æ˜¯å¦ä½¿ç”¨</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>ss -tuln | grep -E &quot;6443|2379|2380|10250|10259|10257|30000-32767&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>æ‰§è¡Œç»“æœ,æ— å ç”¨</li></ul><figure><img src="/assets/662652-20231224221252689-2049707927-DALMpeB1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="å®‰è£…-k8s-v1-18-8" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-k8s-v1-18-8"><span>å®‰è£… K8S v1.18.8</span></a></h2><p>éƒ½2023å¹´äº†ï¼Œä¸ºä»€ä¹ˆè¿˜æ˜¯ v1.18.8ï¼Ÿ</p><p>å› ä¸ºå…¬å¸ç”¨çš„è¿™ä¸ªç‰ˆæœ¬ï¼Œå¹¶ä¸”åé¢è¦è´Ÿè´£æ­å»ºï¼Œè¶æ­¤å‘¨æœ«ï¼Œå®è·µä¸€äºŒï¼Œç¡®è®¤å¯è¡Œï¼Œé‚ä¸å›åˆ†äº«ã€‚</p><h3 id="èŠ‚ç‚¹åˆå§‹åŒ–" tabindex="-1"><a class="header-anchor" href="#èŠ‚ç‚¹åˆå§‹åŒ–"><span>èŠ‚ç‚¹åˆå§‹åŒ–</span></a></h3><ul><li><strong>æ‰§è¡Œä¸»æœºï¼š</strong> <strong>master</strong> <strong>,worker01,worker02</strong></li><li>å…³é—­é˜²ç«å¢™</li><li>å…³é—­swapåˆ†åŒº</li><li>å…è®¸ iptables æ£€æŸ¥æ¡¥æ¥æµé‡</li><li>æ·»åŠ é˜¿é‡Œäº‘ yum æº</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># å…³é—­é˜²ç«å¢™</span></span>
<span class="line"><span>systemctl stop firewalld</span></span>
<span class="line"><span># è®¾ç½®æ°¸ä¹…ä¸å¼€å¯é˜²ç«å¢™</span></span>
<span class="line"><span>systemctl disable firewalld</span></span>
<span class="line"><span></span></span>
<span class="line"><span># å…³é—­swap åˆ†åŒº </span></span>
<span class="line"><span>swapoff -a   </span></span>
<span class="line"><span>#æ°¸ä¹…å…³é—­</span></span>
<span class="line"><span>sed -ri &#39;s/.*swap.*/#&amp;/&#39; /etc/fstab</span></span>
<span class="line"><span></span></span>
<span class="line"><span># å°† SELinux è®¾ç½®ä¸º permissive æ¨¡å¼ï¼ˆç›¸å½“äºå°†å…¶ç¦ç”¨ï¼‰</span></span>
<span class="line"><span>setenforce 0</span></span>
<span class="line"><span>sed -i &#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39; /etc/selinux/config</span></span>
<span class="line"><span></span></span>
<span class="line"><span># å…è®¸ iptables æ£€æŸ¥æ¡¥æ¥æµé‡</span></span>
<span class="line"><span>cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt; EOF</span></span>
<span class="line"><span>net.bridge.bridge-nf-call-ip6tables = 1</span></span>
<span class="line"><span>net.bridge.bridge-nf-call-iptables = 1</span></span>
<span class="line"><span>net.ipv4.ip_forward = 1</span></span>
<span class="line"><span>EOF</span></span>
<span class="line"><span></span></span>
<span class="line"><span># æ·»åŠ é˜¿é‡Œäº‘ yum æº</span></span>
<span class="line"><span>cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt; EOF</span></span>
<span class="line"><span>[kubernetes]</span></span>
<span class="line"><span>name=Kubernetes</span></span>
<span class="line"><span>baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span></span>
<span class="line"><span>enabled=1</span></span>
<span class="line"><span>gpgcheck=0</span></span>
<span class="line"><span>repo_gpgcheck=0</span></span>
<span class="line"><span>gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span></span>
<span class="line"><span>EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®‰è£…kubeadm-kubelet-kubectl" tabindex="-1"><a class="header-anchor" href="#å®‰è£…kubeadm-kubelet-kubectl"><span>å®‰è£…kubeadm&amp;kubelet&amp;kubectl</span></a></h3><ul><li><strong>æ‰§è¡Œä¸»æœºï¼š</strong> <strong>master</strong> <strong>,worker01,worker02</strong></li><li><code>kubeadm</code>ï¼šç”¨æ¥åˆå§‹åŒ–é›†ç¾¤çš„æŒ‡ä»¤ã€‚</li><li><code>kubelet</code>ï¼šåœ¨é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šç”¨æ¥å¯åŠ¨ Pod å’Œå®¹å™¨ç­‰ã€‚</li><li><code>kubectl</code>ï¼šç”¨æ¥ä¸é›†ç¾¤é€šä¿¡çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># å®‰è£…</span></span>
<span class="line"><span>yum install -y kubeadm-1.18.8 kubelet-1.18.8 kubectl-1.18.8 ipvsadm</span></span>
<span class="line"><span># è‡ªå¯</span></span>
<span class="line"><span>sudo systemctl enable --now kubelet</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>éªŒè¯æ˜¯å¦å®‰è£…å®Œæˆ</p><ul><li><code>kubelet --version</code></li><li><code>kubeadm version</code></li><li><code>kubectl version</code></li></ul></li></ul><h3 id="å®‰è£…å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#å®‰è£…å®¹å™¨"><span>å®‰è£…å®¹å™¨</span></a></h3><ul><li><strong>æ‰§è¡Œä¸»æœºï¼š</strong> <strong>master</strong> <strong>,worker01,worker02</strong></li></ul><p>åœ¨ Docker 19.x ç‰ˆæœ¬ä¹‹å‰ï¼ŒDocker ä½¿ç”¨è‡ªå·±çš„å®¹å™¨è¿è¡Œæ—¶ï¼ˆç§°ä¸º Docker Runtimeï¼‰ã€‚ä» Docker 19.x ç‰ˆæœ¬å¼€å§‹ï¼ŒDocker Engine å¼€å§‹ä½¿ç”¨ containerd ä½œä¸ºé»˜è®¤çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œä»¥æä¾›æ›´ç¨³å®šã€å¯é çš„å®¹å™¨ç®¡ç†åŠŸèƒ½ã€‚</p><ul><li>k8s v1.18.8 ç‰ˆæœ¬ï¼Œå®‰è£…docker v24 æš‚æœªé‡åˆ°é—®é¢˜</li><li>åˆ¤æ–­æ˜¯å¦å¯ç”¨:<code>systemctl status containerd</code></li><li>å®‰è£…dockeråŠcontainer</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-vault-8.5.2111.repo</span></span>
<span class="line"><span>rm /etc/yum.repos.d/CentOS-Linux-AppStream.repo -f</span></span>
<span class="line"><span>rm /etc/yum.repos.d/CentOS-Linux-BaseOS.repo -f</span></span>
<span class="line"><span>dnf clean all</span></span>
<span class="line"><span>sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></span>
<span class="line"><span>sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span></span>
<span class="line"><span>sudo yum install -y docker-ce-3:24.0.0-1.el8 docker-ce-cli-1:24.0.6-1.el8 containerd.io docker-buildx-plugin docker-compose-plugin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯å‚è€ƒ <a href="https://juejin.cn/post/7283873796977197108" target="_blank" rel="noopener noreferrer">Docker V24 åŠ Docker Compose V2 çš„å®‰è£…åŠä½¿ç”¨</a></p><h3 id="è®¾ç½®èŠ‚ç‚¹ç½‘ç»œçš„åˆ«å" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®èŠ‚ç‚¹ç½‘ç»œçš„åˆ«å"><span>è®¾ç½®èŠ‚ç‚¹ç½‘ç»œçš„åˆ«å</span></a></h3><ul><li><strong>æ‰§è¡Œä¸»æœºï¼š</strong> <strong>master</strong> <strong>,worker01,worker02</strong></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cat &gt;&gt; /etc/hosts &lt;&lt; EOF</span></span>
<span class="line"><span>192.168.123.100 master</span></span>
<span class="line"><span>192.168.123.101 worker01</span></span>
<span class="line"><span>192.168.123.102 worker02</span></span>
<span class="line"><span>EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆå§‹åŒ–é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#åˆå§‹åŒ–é›†ç¾¤"><span>åˆå§‹åŒ–é›†ç¾¤</span></a></h3><ul><li><strong>æ‰§è¡Œä¸»æœºï¼š</strong> <strong>master</strong></li><li>--apiserver-advertise-addressï¼šæŒ‡å®šé€šè®¯èŠ‚ç‚¹ï¼Œä½¿ç”¨masterèŠ‚ç‚¹å³å¯</li><li>--image-repositoryï¼šk8så®˜ç½‘é•œåƒåº“</li><li>--service-cidr: svcç½‘ç»œçš„ipæ®µè®¾ç½®</li><li>--pod-network-cidr:podçš„ipæ®µé…ç½®ï¼Œæ¯ä¸ªpodéƒ½ä¼šæœ‰è‡ªå·±çš„ip <a href="https://github.com/flannel-io/flannel/blob/master/Documentation/kube-flannel.yml" target="_blank" rel="noopener noreferrer">kube-flannel.yml</a> é»˜è®¤ 10.244.0.0/16</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubeadm init \</span></span>
<span class="line"><span>  --apiserver-advertise-address=192.168.123.100 \</span></span>
<span class="line"><span>  --image-repository registry.aliyuncs.com/google_containers \</span></span>
<span class="line"><span>  --kubernetes-version v1.18.8 \</span></span>
<span class="line"><span>  --service-cidr=10.10.0.0/16 \</span></span>
<span class="line"><span>  --pod-network-cidr=10.244.0.0/16 \</span></span>
<span class="line"><span>  --ignore-preflight-errors=all</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ‰§è¡Œç»“æœï¼Œåˆ›å»ºæˆåŠŸ</li></ul><figure><img src="/assets/662652-20231224221252703-364126435-CPvknbFc.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>è¾“å‡ºç»“æœå¦‚ä¸‹</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>æ‚¨çš„Kubernetesæ§åˆ¶å¹³é¢å·²æˆåŠŸåˆå§‹åŒ–ï¼</span></span>
<span class="line"><span></span></span>
<span class="line"><span>è¦å¼€å§‹ä½¿ç”¨é›†ç¾¤ï¼Œérootç”¨æˆ·éœ€è¦ä½¿ç”¨ä»¥ä¸‹æ“ä½œï¼š</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  mkdir -p $HOME/.kube</span></span>
<span class="line"><span>  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span></span>
<span class="line"><span>  sudo chown $(id -u):$(id -g) $HOME/.kube/config</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æ‚¨ç°åœ¨åº”è¯¥å‘é›†ç¾¤éƒ¨ç½²ä¸€ä¸ªpodç½‘ç»œã€‚</span></span>
<span class="line"><span>Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:</span></span>
<span class="line"><span>  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>ç„¶åï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥rootèº«ä»½åœ¨æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šè¿è¡Œä»¥ä¸‹æ“ä½œæ¥åŠ å…¥ä»»æ„æ•°é‡çš„å·¥ä½œèŠ‚ç‚¹ï¼š</span></span>
<span class="line"><span>kubeadm join 192.168.123.100:6443 --token nn9das.wslckjkd1ng3oxui \</span></span>
<span class="line"><span>    --discovery-token-ca-cert-hash sha256:7b3f413e6bfbd1f91448460426a144741bd14c2bb3119cfa058d07d65ab329fd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®é›†ç¾¤èº«ä»½éªŒè¯æ–‡ä»¶</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>  mkdir -p $HOME/.kube</span></span>
<span class="line"><span>  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span></span>
<span class="line"><span>  sudo chown $(id -u):$(id -g) $HOME/.kube/config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‹¥ä¸é…ç½®ç›´æ¥ä½¿ç”¨ kubectl ç›¸å…³å‘½ä»¤ä¼šæç¤ºï¼š<code>The connection to the server ``localhost:8080`` was refused - did you specify the right host or port?</code></p><p>æƒ³è¦åœ¨å“ªé‡Œç®¡ç†k8s å°±è¦å°† .kube æ–‡ä»¶å¤¹æ‹·è´åˆ°ç›®æ ‡ä¸»æœºï¼Œå³å·¥ä½œèŠ‚ç‚¹éœ€è¦å¤åˆ¶ .kube ç›®å½•åˆ° $HOME ç›®å½•ä¸­</p><h3 id="å®‰è£…ç½‘ç»œæ’ä»¶-flannel" tabindex="-1"><a class="header-anchor" href="#å®‰è£…ç½‘ç»œæ’ä»¶-flannel"><span>å®‰è£…ç½‘ç»œæ’ä»¶ flannel</span></a></h3><ul><li>ä¸‹è½½ <a href="https://github.com/flannel-io/flannel/blob/master/Documentation/kube-flannel.yml" target="_blank" rel="noopener noreferrer">kube-flannel.yml</a></li><li>è‹¥åˆå§‹åŒ–æ—¶æŒ‡å®šäº† --pod-network-cidr åˆ™éœ€è¦ä¿®æ”¹é…ç½®ä¸­ net-conf.json:Network é¡¹</li><li>æ‰§è¡Œå®‰è£…</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml --insecure-skip-tls-verify</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="workerèŠ‚ç‚¹é…ç½®" tabindex="-1"><a class="header-anchor" href="#workerèŠ‚ç‚¹é…ç½®"><span>workerèŠ‚ç‚¹é…ç½®</span></a></h3><ul><li><strong>æ‰§è¡Œä¸»æœºï¼šworker01,worker02</strong></li><li>æ ¹æ®å‰é¢çš„ ç¯å¢ƒè®¾ç½®ï¼Œk8så·¥å…·å®‰è£…ï¼Œdockerå®‰è£…ï¼Œåœ¨workerèŠ‚ç‚¹ä¹Ÿæ‰§è¡Œï¼Œè¿›è¡Œåˆå§‹åŒ–</li><li>å°†workerèŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼šæ‰§è¡Œmasteråˆå§‹åŒ–åè¾“å‡ºçš„joinå‘½ä»¤</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubeadm join 192.168.123.100:6443 --token e270ma.bjeg9k1g3e5k1q2h \</span></span>
<span class="line"><span>    --discovery-token-ca-cert-hash sha256:7beaa6a51994a7d63544ba1d410504ffe8e58a66746c507d3ff09dd15244a813</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è‹¥æ‰¾ä¸åˆ°æˆ–å¤±æ•ˆå¯é€šè¿‡ï¼š<code>kubeadm token create --print-join-command</code>é‡æ–°ç”Ÿæˆjoinå‘½ä»¤</li><li>å¤åˆ¶ master èŠ‚ç‚¹çš„k8sé…ç½®æ–‡ä»¶ $HOME/.kube/config åˆ°å·¥ä½œèŠ‚ç‚¹</li><li>å®‰è£…ç½‘ç»œæ’ä»¶ flannel</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>khttps://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml --insecure-skip-tls-verify</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="å®‰è£…-dashboard-v2-0-3" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-dashboard-v2-0-3"><span>å®‰è£… Dashboard v2.0.3</span></a></h2><blockquote><p>Kubernetes Dashboard æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å’Œç›‘æ§ Kubernetes é›†ç¾¤çš„ Web ç”¨æˆ·ç•Œé¢ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç›´è§‚çš„å›¾å½¢ç•Œé¢ï¼Œå¯ä»¥å¸®åŠ©ä½ æŸ¥çœ‹å’Œç®¡ç†é›†ç¾¤ä¸­çš„å„ç§èµ„æºã€éƒ¨ç½²åº”ç”¨ç¨‹åºã€ç›‘æ§é›†ç¾¤çŠ¶æ€ç­‰</p></blockquote><ul><li><a href="https://github.com/kubernetes/dashboard" target="_blank" rel="noopener noreferrer">å®˜æ–¹ä»“åº“</a></li><li>æ‰§è¡Œ <a href="https://github.com/kubernetes/dashboard/blob/v2.0.4/aio/deploy/recommended.yaml" target="_blank" rel="noopener noreferrer">recommended.yaml</a>, å®‰è£…é¢æ¿ï¼Œå®Œå…¨æ”¯æŒçš„ç‰ˆæœ¬ä¸º <a href="https://github.com/kubernetes/dashboard/releases/tag/v2.0.3" target="_blank" rel="noopener noreferrer">v2.0.3</a></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>è‹¥éœ€è¦ä¿®æ”¹tokené»˜è®¤15åˆ†é’Ÿçš„è¿‡æœŸæ—¶é—´ä¸º7å¤©ï¼Œä¿®æ”¹å¯¹åº”å‚æ•°å³å¯</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>args:</span></span>
<span class="line"><span>- --auto-generate-certificates</span></span>
<span class="line"><span>- --namespace=kubernetes-dashboard</span></span>
<span class="line"><span>- --token-ttl=604800</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é»˜è®¤åˆ›å»ºçš„ kubernetes-dashboard æ— æƒé™ï¼Œæ‰€ä»¥éœ€è¦æˆæƒï¼Œè¿™é‡Œç›´æ¥åˆ›å»ºä½¿ç”¨å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ· admin å¹¶æˆæƒ</li><li>åˆ›å»ºç”¨æˆ·</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cat &lt;&lt;EOF | kubectl apply -f -</span></span>
<span class="line"><span>apiVersion: v1</span></span>
<span class="line"><span>kind: ServiceAccount</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: admin</span></span>
<span class="line"><span>  namespace: kubernetes-dashboard</span></span>
<span class="line"><span>EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è§’è‰²æˆæƒ</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cat &lt;&lt;EOF | kubectl apply -f -</span></span>
<span class="line"><span>apiVersion: rbac.authorization.k8s.io/v1</span></span>
<span class="line"><span>kind: ClusterRoleBinding</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: admin</span></span>
<span class="line"><span>roleRef:</span></span>
<span class="line"><span>  apiGroup: rbac.authorization.k8s.io</span></span>
<span class="line"><span>  kind: ClusterRole</span></span>
<span class="line"><span>  name: cluster-admin</span></span>
<span class="line"><span>subjects:</span></span>
<span class="line"><span>- kind: ServiceAccount</span></span>
<span class="line"><span>  name: admin</span></span>
<span class="line"><span>  namespace: kubernetes-dashboard</span></span>
<span class="line"><span>EOF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è·å–ç™»é™†token</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep kubernetes-dashboard| awk &#39;{print $1}&#39;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@master ~]# kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep admin | awk &#39;{print $1}&#39;)</span></span>
<span class="line"><span>Name:         admin-token-4nqqz</span></span>
<span class="line"><span>Namespace:    kubernetes-dashboard</span></span>
<span class="line"><span>Labels:       &lt;none&gt;</span></span>
<span class="line"><span>Annotations:  kubernetes.io/service-account.name: admin</span></span>
<span class="line"><span>              kubernetes.io/service-account.uid: 6f432133-5007-4d8b-9239-8c55efa03826</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Type:  kubernetes.io/service-account-token</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Data</span></span>
<span class="line"><span>====</span></span>
<span class="line"><span>ca.crt:     1025 bytes</span></span>
<span class="line"><span>namespace:  20 bytes</span></span>
<span class="line"><span>token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IlUycUl0Zmpnb0Y4Z2FWXzVkbmtjSjR6UngwNW05Z0tDcjVydklLWURYY1EifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi10b2tlbi00bnFxeiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJhZG1pbiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjZmNDMyMTMzLTUwMDctNGQ4Yi05MjM5LThjNTVlZmEwMzgyNiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlcm5ldGVzLWRhc2hib2FyZDphZG1pbiJ9.J8nXyfpWjs9IbnvdfrW5hSq5SkCWy16NL89nphiDk-UGZP0qbcx0xQG_IfmTUfO0lxDQdD84VyZ8EzLENtwtqt3oIVZQyyyUAonOzqnAUfN3l9Jd_uFVbZhS_tfnwC3p4z2htUpDfXNLFoA4hav-2EgT6wY3voIZtnarfNvvBCBCimi-pG4AcCvc34V_udpYRXYpP1IPswS82NMTBVt_T1Y8gm_zKwq8LH6Z4LYr6wdr3MxGT4Fr7H5GK1jVS_wbna06HEK-GI_szNf5u-zRTMP5Si4JOHxnEWwHH4keLG6ez0pwkk5jYTqncczeb91Es_zZE95rvLxn1yh2mzAP5g</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æš´éœ²åˆ°é›†ç¾¤å¤–</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubectl patch svc kubernetes-dashboard -n kubernetes-dashboard -p &#39;{&quot;spec&quot;:{&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[{&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30001}]}}&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>ä½¿ç”¨ Chrome è®¿é—®ï¼šhttps://192.168.123.102:30001/#/login</li></ul><figure><img src="/assets/662652-20231224221252736-435736867-Dxrfwymu.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>å› ä¸ºè¦æ±‚å¿…é¡»è¦ä½¿ç”¨httpsï¼Œæ‰€ä»¥ç»“åˆä¹‹å‰æ–‡ç« **<a href="https://www.cnblogs.com/morang/p/devops-nginx-install-use.html" target="_blank" rel="noopener noreferrer">å‰åç«¯éƒ½ç”¨å¾—ä¸Šçš„ Nginx æ—¥å¸¸ä½¿ç”¨ç»éªŒ</a>**ï¼Œç”Ÿæˆè¯ä¹¦å¹¶æ·»åŠ åŸŸåé…ç½®</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>server {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    listen 80;</span></span>
<span class="line"><span>    listen       443 ssl;</span></span>
<span class="line"><span>    server_name k8s.devops.test.com;  # è‡ªè¡Œä¿®æ”¹æˆä½ çš„åŸŸå</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    ssl_certificate      /certs/k8s.devops.test.com/server.crt;</span></span>
<span class="line"><span>    ssl_certificate_key  /certs/k8s.devops.test.com/server.key;</span></span>
<span class="line"><span>    ssl_session_cache    shared:SSL:1m;</span></span>
<span class="line"><span>    ssl_session_timeout  5m;</span></span>
<span class="line"><span>    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span>
<span class="line"><span>    ssl_prefer_server_ciphers  on;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    location / {</span></span>
<span class="line"><span>            proxy_pass https://192.168.123.100:30001;</span></span>
<span class="line"><span>            proxy_http_version 1.1;</span></span>
<span class="line"><span>            proxy_buffering off;</span></span>
<span class="line"><span>            proxy_request_buffering off;</span></span>
<span class="line"><span>            proxy_set_header Upgrade $http_upgrade;</span></span>
<span class="line"><span>            proxy_set_header Connection &quot;upgrade&quot;;</span></span>
<span class="line"><span>            proxy_set_header Host $host;</span></span>
<span class="line"><span>            proxy_set_header X-Forwarded-For $remote_addr;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æˆåŠŸä½¿ç”¨https+åŸŸåè®¿é—®</li></ul><figure><img src="/assets/662652-20231224221252709-1081319541-BLPuJAI4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>å‡çº§é¢æ¿ç‰ˆæœ¬ v2.2.0ï¼Œå¯ä»¥æ›´å¥½çš„æ˜¾ç¤º ingress ç›¸å…³ä¿¡æ¯</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># åˆ é™¤pod</span></span>
<span class="line"><span>kubectl -n kubernetes-dashboard delete $(kubectl -n kubernetes-dashboard get pod -o name | grep dashboard)</span></span>
<span class="line"><span># é‡æ–°éƒ¨ç½²v2.2.0</span></span>
<span class="line"><span>kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.2.0/aio/deploy/recommended.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®‰è£…-metrics-server-v0-3-7" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-metrics-server-v0-3-7"><span>å®‰è£… Metrics Server v0.3.7</span></a></h2><blockquote><p>Metrics Server æ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†é›†ç¾¤ä¸­å„ä¸ªç»„ä»¶çš„èµ„æºä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½æŒ‡æ ‡æ•°æ®çš„ç»„ä»¶ã€‚å®‰è£…åå¯ä»¥åœ¨é¢æ¿ä¸­æˆ–ä½¿ç”¨å‘½ä»¤ kubectl top node æŸ¥çœ‹é›†ç¾¤ä½¿ç”¨æƒ…å†µ</p></blockquote><ul><li><p><a href="https://github.com/kubernetes-sigs/metrics-server" target="_blank" rel="noopener noreferrer">å®˜æ–¹ä»“åº“</a></p></li><li><p>k8s v1.18 å¯¹åº”å¯ä»¥ä½¿ç”¨ <a href="https://github.com/kubernetes-sigs/metrics-server/tree/v0.3.7/deploy" target="_blank" rel="noopener noreferrer">v0.3.7</a> éƒ¨ç½²æ–‡ä»¶ metrics-server/deploy/1.8+/</p></li><li><p>ä¿®æ”¹é…ç½® metrics-server-deployment.yaml</p><ul><li>ä¿®æ”¹é•œåƒæºï¼š<code>registry.aliyuncs.com/google_containers</code></li><li>æ–°å¢commandé…ç½®è·³è¿‡è¯ä¹¦çš„éªŒè¯ï¼š <code>-kubelet-insecure-tls</code></li><li>è®¾ç½®é¦–é€‰é€šä¿¡ç±»å‹ï¼š<code>--kubelet-preferred-address-types=InternalDNS,InternalIP,ExternalDNS,ExternalIP,Hostname</code></li></ul></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># ...</span></span>
<span class="line"><span>spec:</span></span>
<span class="line"><span>      serviceAccountName: metrics-server</span></span>
<span class="line"><span>      volumes:</span></span>
<span class="line"><span>      # mount in tmp so we can safely use from-scratch images and/or read-only containers</span></span>
<span class="line"><span>      - name: tmp-dir</span></span>
<span class="line"><span>        emptyDir: {}</span></span>
<span class="line"><span>      containers:</span></span>
<span class="line"><span>      - name: metrics-server</span></span>
<span class="line"><span>        # ä¿®æ”¹é•œåƒæº image: k8s.gcr.io/metrics-server/metrics-server:v0.3.7</span></span>
<span class="line"><span>        image: registry.aliyuncs.com/google_containers/metrics-server:v0.3.7</span></span>
<span class="line"><span>        imagePullPolicy: IfNotPresent</span></span>
<span class="line"><span>        # æ–°å¢commandé…ç½®</span></span>
<span class="line"><span>        command:</span></span>
<span class="line"><span>        - /metrics-server</span></span>
<span class="line"><span>        # è·³è¿‡ Kubernetes API Server å¯¹ Kubelet TLS è¯ä¹¦çš„éªŒè¯</span></span>
<span class="line"><span>        - --kubelet-insecure-tls</span></span>
<span class="line"><span>        # é€šä¿¡æ—¶é¦–é€‰çš„åœ°å€ç±»å‹</span></span>
<span class="line"><span>        - --kubelet-preferred-address-types=InternalDNS,InternalIP,ExternalDNS,ExternalIP,Hostname</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ‹·è´æ–‡ä»¶åˆ°æœåŠ¡å™¨æˆ–ç›´æ¥åœ¨masterèŠ‚ç‚¹ä¿®æ”¹</li><li>åˆ°è€ƒæœ¬æ–‡ä»¶çš„ç›®å½•æ‰§è¡Œå‘½ä»¤å®‰è£…å³å¯</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>cd /app/k8s/</span></span>
<span class="line"><span>kubectl apply -f metrics-server-0.3.7/deploy/1.8+/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç›®å½•ç»“æ„åŠä¿®æ”¹</li></ul><figure><img src="/assets/662652-20231224221252710-2137788827-DnOMLZ7F.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>æ‰§è¡ŒæˆåŠŸ</li></ul><figure><img src="/assets/662652-20231224221252699-1638896453-DjHDVjtu.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ç­‰å¾…podéƒ¨ç½²æˆåŠŸååˆ·æ–°é¡µé¢å¯ä»¥çœ‹åˆ°ç›‘æ§å°±å‡ºæ¥äº†</li></ul><figure><img src="/assets/662652-20231224221252721-27097896-Cggt01Zq.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/assets/662652-20231224221252733-612408733-C7kkZ4e4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ä½¿ç”¨ <code>kubectl top node</code>æŸ¥çœ‹èŠ‚ç‚¹èµ„æºä½¿ç”¨æƒ…å†µ</li></ul><figure><img src="/assets/662652-20231224221252691-373556356-Btu5u_gu.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ä½¿ç”¨ <code>kubectl top pod -A</code> æŸ¥çœ‹ Pod èµ„æºä½¿ç”¨æƒ…å†µ</li></ul><h2 id="å®‰è£…-helm-v3-13-1" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-helm-v3-13-1"><span>å®‰è£… Helm v3.13.1</span></a></h2><blockquote><p>Kubernetes Helm æ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·ï¼Œç”¨äºåœ¨ Kubernetes ç¯å¢ƒä¸­ç®€åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²å’Œç®¡ç†ã€‚Helm å…è®¸ä½ å®šä¹‰ã€å®‰è£…å’Œå‡çº§ Kubernetes åº”ç”¨ç¨‹åºçš„é¢„å®šä¹‰è½¯ä»¶åŒ…ï¼Œè¿™äº›è½¯ä»¶åŒ…ç§°ä¸º Helm Chartsã€‚</p></blockquote><ul><li><a href="https://github.com/helm/helm" target="_blank" rel="noopener noreferrer">å®˜æ–¹ä»“åº“</a></li><li>å®‰è£…v3ç‰ˆæœ¬</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>å®‰è£…æˆåŠŸï¼Œç‰ˆæœ¬ä¸º v3.13.1</li></ul><figure><img src="/assets/662652-20231224221252744-1299430260-uFAkuHWH.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>å®‰è£…ç›®å½•ï¼š/usr/local/bin/helm</li><li>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªè­¦å‘Šè¯´æ²¡æœ‰å®‰è£…git, å› ä¸º Helm åœ¨å®‰è£…æ’ä»¶(<a href="https://github.com/chartmuseum/helm-push" target="_blank" rel="noopener noreferrer">pushæ’ä»¶</a>)æ—¶éœ€è¦ä½¿ç”¨ Gitï¼Œæ‰€ä»¥å¯ä»¥é¡ºæ‰‹å®‰è£…ä¸€ä¸‹ git</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>sudo dnf install git -y</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>æŸ¥çœ‹Helmä»“åº“åˆ—è¡¨ï¼š<code>helm repo list</code> ï¼Œé»˜è®¤ä¸ºç©ºï¼Œå¦‚æœè¦æŒ‰ç…§ä»€ä¹ˆåº”ç”¨ï¼Œéœ€è¦æ·»åŠ å¯¹åº”çš„ä»“åº“</li><li>helm æœç´¢åº”ç”¨ï¼š<code>helm search repo ingress-nginx/ingress-nginx --version=&#39;&lt;4&#39;</code></li><li>helm å¸è½½åº”ç”¨ï¼š<code>helm uninstall -n ingress-nginx ingress-nginx</code></li><li>å…·ä½“ä½¿ç”¨å¯å‚è€ƒä¸‹é¢å®‰è£… ingress-nginx</li><li>åœ¨ Helm ä¸­ä¿®æ”¹é•œåƒæºéœ€è¦ä½¿ç”¨ <code>--set</code> æˆ– <code>--set-string</code> å‚æ•°æ¥è¦†ç›–é»˜è®¤å€¼ã€‚å¯¹äº Nginx Ingress Controllerï¼Œå¯ä»¥é€šè¿‡æŒ‡å®š <code>controller.image.repository</code> å’Œ <code>controller.image.tag</code> æ¥ä¿®æ”¹é•œåƒæºçš„åŒ…åœ°å€å’Œç‰ˆæœ¬ã€‚è¿™ä¸ªåœ¨å®‰è£…ingress-nginxå°±æœ‰ä½¿ç”¨ï¼Œåœ¨æ— æ³•ä½¿ç”¨å®˜æ–¹é•œåƒçš„æ—¶å€™ä¸€èˆ¬éƒ½éœ€è¦æ›¿æ¢ä¸ºå›½å†…é•œåƒ</li></ul><h2 id="ä½¿ç”¨-k8s-é›†ç¾¤éƒ¨ç½²æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-k8s-é›†ç¾¤éƒ¨ç½²æœåŠ¡"><span>ä½¿ç”¨ K8S é›†ç¾¤éƒ¨ç½²æœåŠ¡</span></a></h2><h3 id="å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨å‘½ä»¤"><span>å¸¸ç”¨å‘½ä»¤</span></a></h3><ul><li>éƒ¨ç½²æœåŠ¡ï¼š<code>kubectl apply -f é…ç½®æ–‡ä»¶å.yml</code></li><li>æŸ¥çœ‹å‰¯æœ¬é›†ä¿¡æ¯ï¼š<code>kubectl get replicasets</code></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@master tests]# kubectl get replicasets</span></span>
<span class="line"><span>NAME                  DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span>my-nginx-69448bd7d9   2         2         2       36m</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æŸ¥çœ‹ Deployment ä¿¡æ¯ï¼š<code>kubectl describe deployments my-nginx</code></li></ul><figure><img src="/assets/662652-20231224221252713-2086538077-BG7KCS8n.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>æŸ¥çœ‹ Service ä¿¡æ¯ï¼š<code>kubectl get services my-nginx-service</code></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@master tests]# kubectl get services my-nginx-service</span></span>
<span class="line"><span>NAME               TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE</span></span>
<span class="line"><span>my-nginx-service   NodePort   10.10.143.180   &lt;none&gt;        80:30080/TCP   35m</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é›†ç¾¤ä¸­å¯ä»¥ä½¿ç”¨æ­¤æœåŠ¡IPè¿›è¡Œé€šè®¯</p><figure><img src="/assets/662652-20231224221252684-2046522162-CZL7YSdN.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>æŸ¥çœ‹éƒ¨ç½²çš„ nginx æœåŠ¡çš„ Pod :<code>kubectl get pods --selector=app=my-nginx</code></li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@master tests]# kubectl get pods --selector=app=my-nginx</span></span>
<span class="line"><span>NAME                        READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span>my-nginx-69448bd7d9-q8xtl   1/1     Running   0          39m</span></span>
<span class="line"><span>my-nginx-69448bd7d9-zghxb   1/1     Running   0          30m</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åˆ é™¤æœåŠ¡ï¼š<code>kubectl delete services my-nginx-service</code></li><li>åˆ é™¤è´Ÿè½½ï¼š<code>kubectl delete deployment my-nginx</code></li></ul><h3 id="éƒ¨ç½²ä¸€ä¸ª-nginx-æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#éƒ¨ç½²ä¸€ä¸ª-nginx-æœåŠ¡"><span>éƒ¨ç½²ä¸€ä¸ª nginx æœåŠ¡</span></a></h3><ul><li>é…ç½®ä¸€ä¸ªç®€å•çš„ nginx æœåŠ¡ï¼šnginx.yml</li><li>éƒ¨ç½²äº† Deployment å’Œ Service</li><li>æš´éœ²äº†å®¹å™¨çš„ç«¯å£ï¼š80</li><li>æš´éœ²é›†ç¾¤å¤–çš„ç«¯å£ï¼š30080</li><li>è®¾ç½®äº†2ä¸ªå‰¯æœ¬ï¼š<code>replicas: 2</code></li><li>å®Œæ•´é…ç½®æ–‡ä»¶</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>apiVersion: apps/v1</span></span>
<span class="line"><span>kind: Deployment</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: my-nginx</span></span>
<span class="line"><span>spec:</span></span>
<span class="line"><span>  replicas: 2</span></span>
<span class="line"><span>  selector:</span></span>
<span class="line"><span>    matchLabels:</span></span>
<span class="line"><span>      app: my-nginx</span></span>
<span class="line"><span>  template:</span></span>
<span class="line"><span>    metadata:</span></span>
<span class="line"><span>      labels:</span></span>
<span class="line"><span>        app: my-nginx</span></span>
<span class="line"><span>    spec:</span></span>
<span class="line"><span>      containers:</span></span>
<span class="line"><span>        - name: my-nginx</span></span>
<span class="line"><span>          image: nginx:latest</span></span>
<span class="line"><span>          ports:</span></span>
<span class="line"><span>            - containerPort: 80</span></span>
<span class="line"><span>---</span></span>
<span class="line"><span>apiVersion: v1</span></span>
<span class="line"><span>kind: Service</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: my-nginx-service</span></span>
<span class="line"><span>spec:</span></span>
<span class="line"><span>  selector:</span></span>
<span class="line"><span>    app: my-nginx</span></span>
<span class="line"><span>  type: NodePort</span></span>
<span class="line"><span>  ports:</span></span>
<span class="line"><span>    - protocol: TCP</span></span>
<span class="line"><span>      port: 80</span></span>
<span class="line"><span>      targetPort: 80</span></span>
<span class="line"><span>      nodePort: 30080</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä¸Šä¼ åˆ°æœåŠ¡å™¨æ‰§è¡Œï¼š<code>kubectl apply -f nginx.yml</code></li><li>éƒ¨ç½²æˆåŠŸåä½¿ç”¨èŠ‚ç‚¹IP+ç«¯å£å·å³å¯è®¿é—®</li></ul><figure><img src="/assets/662652-20231224221252690-1293840678-D2L-rm1o.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ç›®å‰éƒ¨ç½²äº†ä¸¤ä¸ªæœåŠ¡ï¼Œä½†æ˜¯å¯ä»¥ç›®å‰æ²¡æœ‰èƒ½å¤Ÿè®¾ç½®è´Ÿè½½çš„åœ°æ–¹ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸€ä¸ª Ingress æ§åˆ¶å™¨æ¥ç®¡ç†æµé‡å’Œè´Ÿè½½å‡è¡¡</li></ul><h2 id="ä½¿ç”¨-ingress-nginx-v3-41è¿›è¡ŒæœåŠ¡è´Ÿè½½" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-ingress-nginx-v3-41è¿›è¡ŒæœåŠ¡è´Ÿè½½"><span>ä½¿ç”¨ Ingress-Nginx v3.41è¿›è¡ŒæœåŠ¡è´Ÿè½½</span></a></h2><blockquote><p>Kubernetes é»˜è®¤ä½¿ç”¨çš„è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯åŸºäº IP çš„è½®è¯¢ï¼ˆIP-based round-robinï¼‰ï¼Œå®ƒä¼šå°†è¯·æ±‚æŒ‰ç…§æº IP åœ°å€çš„é¡ºåºåˆ†å‘åˆ°ä¸åŒçš„ Pod ä¸Šã€‚å¦‚æœéœ€è¦å…¶ä»–è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¯ä»¥ä½¿ç”¨ Ingress æ§åˆ¶å™¨æˆ–è€…è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆ</p><p>å¦‚æœä½¿ç”¨ Kubernetes 1.19 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ NGINX Ingress Controller;</p><p>å¦‚æœä½¿ç”¨æ—§ç‰ˆæœ¬çš„ Kubernetesï¼ˆ1.18 æˆ–æ›´æ—©ç‰ˆæœ¬ï¼‰ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ Ingress-Nginx Controller çš„ 0.X ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 0.49 ç‰ˆæœ¬</p></blockquote><h3 id="å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#å‡†å¤‡"><span>å‡†å¤‡</span></a></h3><ul><li><a href="https://github.com/kubernetes/ingress-nginx" target="_blank" rel="noopener noreferrer">å®˜æ–¹ä»“åº“</a></li><li><a href="https://kubernetes.github.io/ingress-nginx/deploy/#running-on-kubernetes-versions-older-than-119" target="_blank" rel="noopener noreferrer">ç‰ˆæœ¬é€‰æ‹©è¯´æ˜</a></li><li>ArtifactHubï¼š <a href="https://artifacthub.io/packages/helm/ingress-nginx/ingress-nginx/3.41.0" target="_blank" rel="noopener noreferrer">v3.41</a></li><li>ä½¿ç”¨ helm æŸ¥æ‰¾ ingress-nginx åŒ…</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span># æŸ¥è¯¢ä»“åº“åˆ—è¡¨</span></span>
<span class="line"><span>helm repo list</span></span>
<span class="line"><span># æ·»åŠ ä»“åº“åœ°å€</span></span>
<span class="line"><span>helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx</span></span>
<span class="line"><span># æœç´¢åŒ…</span></span>
<span class="line"><span>helm search repo ingress-nginx/ingress-nginx --version=&#39;&lt;4&#39;</span></span>
<span class="line"><span># ingress-nginx/ingress-nginx     3.41.0          0.51.0          Ingress controller for Kubernetes using NGINX a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®‰è£…" tabindex="-1"><a class="header-anchor" href="#å®‰è£…"><span>å®‰è£…</span></a></h3><ul><li>åˆ›å»º namespace</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>kubectl create namespace ingress-nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>å®‰è£… ingress-nginx æºä¸‹çš„ v3.41 ç‰ˆæœ¬ ingress-nginx, æŒ‡å®š namespace ä¸º ingress-nginx,æŒ‡å®šé•œåƒæºä¸ºé˜¿é‡Œäº‘</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>helm install ingress-nginx ingress-nginx/ingress-nginx --namespace ingress-nginx --version 3.41.0 --set controller.image.repository=registry.aliyuncs.com/google_containers/nginx-ingress-controller</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>å¦‚æœå®‰è£…åæŠ¥é”™è´Ÿè½½æ— æ³•å¯åŠ¨ï¼Œå¯èƒ½æ˜¯å› ä¸ºåŒ…æ— æ³•æ‹‰å–ï¼Œå¯æŒ‡å®šé•œåƒæº <code>--set controller.image.repository</code> ä¸ºå›½å†…æº(registry.aliyuncs.com/google_containers/nginx-ingress-controller) é‡æ–°å®‰è£…ï¼ˆå¸è½½ <code>helm uninstall -n ingress-nginx ingress-nginx</code>ï¼‰å³å¯</li><li>å®‰è£…æˆåŠŸï¼Œå¹¶ç»™å‡ºæç¤ºåº”è¯¥å¦‚ä½•ä½¿ç”¨</li></ul><figure><img src="/assets/662652-20231224221252754-1045178623-BiO_AqMX.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><p>å¦‚æœéœ€è¦åœ¨å±€åŸŸç½‘ä¸­ä½¿ç”¨ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸¤ä¸ªé…ç½®</p></li><li><p>ä¿®æ”¹è´Ÿè½½ ingress-nginx-controller é…ç½® ä¿å­˜åç”Ÿæ•ˆ</p><ul><li><code>dnsPolicy: ClusterFirstWithHostNet</code> ç­–ç•¥å°†é¦–å…ˆå°è¯•ä½¿ç”¨ä¸»æœºçš„ DNS è§£ææœåŠ¡æ¥è§£æåŸŸåï¼Œå¦‚æœä¸»æœºçš„ DNS æ— æ³•è§£æè¯¥åŸŸåï¼Œå°†ä¼šå°è¯•ä½¿ç”¨å…¶ä»–é…ç½®çš„ DNS è§£æå™¨</li><li><code>hostNetwork:true</code> Pod ä¸­çš„å®¹å™¨å°†ä½¿ç”¨ä¸»æœºçš„ç½‘ç»œæ ˆå’Œç½‘ç»œé…ç½®</li></ul></li></ul><figure><img src="/assets/662652-20231224221252930-72349938-B7XoM9P4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨"><span>ä½¿ç”¨</span></a></h3><ul><li>é€šè¿‡ Dashboard å³ä¸Šè§’ç›´æ¥åˆ›å»º YAML æ–‡ä»¶</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>apiVersion: extensions/v1beta1</span></span>
<span class="line"><span>kind: Ingress</span></span>
<span class="line"><span>metadata:</span></span>
<span class="line"><span>  name: ingress-nginx-test</span></span>
<span class="line"><span>  namespace: default</span></span>
<span class="line"><span>spec:</span></span>
<span class="line"><span>  rules:</span></span>
<span class="line"><span>  - host: nginx.k8stest.com</span></span>
<span class="line"><span>    http:</span></span>
<span class="line"><span>      paths:</span></span>
<span class="line"><span>      - backend:</span></span>
<span class="line"><span>          serviceName: my-nginx-service</span></span>
<span class="line"><span>          servicePort: 80</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä¿å­˜åå°†ä¼šè½¬å‘åŸŸåè¯·æ±‚åˆ°å‰é¢éƒ¨ç½²çš„ my-nginx-service æœåŠ¡ä¸­ï¼Œæ­¤æ—¶å°†ä½¿ç”¨ ingress-nginx è¿›è¡Œè´Ÿè½½ï¼Œå½“ç„¶ï¼Œè¿˜éœ€è¦å°†åŸŸåè§£æåˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œæœ¬åœ°å±€åŸŸç½‘å¯ä»¥ä½¿ç”¨ hosts æˆ–è€… dns è®¾ç½®</li><li>é€šè¿‡ <code>kubectl describe pod ingress-nginx-controller -n ingress-nginx</code> å¯è·å–åˆ°ingress-nginxæ‰€åœ¨èŠ‚ç‚¹ä¿¡æ¯ï¼ŒIPä¸º 192.168.123.102</li></ul><figure><img src="/assets/662652-20231224221252704-1718555845-CeIipAo-.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>è®¾ç½® hosts <code> 192.168.123.102 nginx.k8stest.com</code>,å†åˆ·æ–°ä¸‹dnsç¼“å­˜ <code>ipconfig /flushdns</code>è®¿é—®å³å¯ï¼Œæ¯æ¬¡åˆ·æ–°éƒ½ä¼šè¯·æ±‚åˆ°ä¸åŒçš„podä¸Šé¢</li></ul><figure><img src="/assets/662652-20231224221252699-424047647-rAn_fY3c.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è‡³æ­¤ï¼Œåœ¨å±€åŸŸç½‘ä¸­å®‰è£…ä½¿ç”¨ k8s v1.18.8,å¹¶è¿›è¡Œç›¸å…³é…ç½®å·²ç»å®Œæˆï¼Œå¾—ç›Šä¸å¤§ä½¬ä»¬çš„åˆ†äº«ï¼Œè€—æ—¶ä¸¤å¤©ï¼Œè¾¹å¼„è¾¹è®°ï¼Œä¼˜åŒ–äº†ä¸€äº›æ­¥éª¤ä¸ç»†èŠ‚ã€‚åç»­å°†å°è¯•å®‰è£…æ›´æ–°çš„ç‰ˆæœ¬ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p><h2 id="è¸©å‘è®°å½•" tabindex="-1"><a class="header-anchor" href="#è¸©å‘è®°å½•"><span>è¸©å‘è®°å½•</span></a></h2><ul><li>ä½¿ç”¨yumå®‰è£…kubeadmæ—¶æŠ¥é”™ï¼Œæµ‹è¯•å‘ç°curlæ— æ³•ä½¿ç”¨ï¼Œé”™è¯¯å¦‚ä¸‹ï¼Œéœ€è¦æ£€æŸ¥è®¾ç½®dns:<code>cat /etc/resolv.conf</code> å†™å…¥é»˜è®¤é…ç½®æˆ–å…¬å‘Šdns: nameserver 192.168.123.1</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[root@master ~]# yum install -y kubeadm-1.18.8 kubelet-1.18.8 kubectl-1.18.8 ipvsadm</span></span>
<span class="line"><span>Repository extras is listed more than once in the configuration</span></span>
<span class="line"><span>CentOS-8.5.2111 - Base - mirrors.aliyun.com                                                                                                                  0.0  B/s |   0  B     00:00</span></span>
<span class="line"><span>Errors during downloading metadata for repository &#39;base&#39;:</span></span>
<span class="line"><span>  - Curl error (6): Couldn&#39;t resolve host name for http://mirrors.aliyun.com/centos-vault/8.5.2111/BaseOS/x86_64/os/repodata/repomd.xml [Could not resolve host: mirrors.aliyun.com]</span></span>
<span class="line"><span>  - Curl error (6): Couldn&#39;t resolve host name for http://mirrors.aliyuncs.com/centos-vault/8.5.2111/BaseOS/x86_64/os/repodata/repomd.xml [Could not resolve host: mirrors.aliyuncs.com]</span></span>
<span class="line"><span>  - Curl error (6): Couldn&#39;t resolve host name for http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/BaseOS/x86_64/os/repodata/repomd.xml [Could not resolve host: mirrors.cloud.aliyuncs.com]</span></span>
<span class="line"><span>Error: Failed to download metadata for repo &#39;base&#39;: Cannot download repomd.xml: Cannot download repodata/repomd.xml: All mirrors were tried</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é˜¿é‡Œäº‘é•œåƒæºçš„ä½¿ç”¨ï¼ŒæŒ‡å®šé•œåƒæºæ—¶éœ€è¦ä½¿ç”¨ <code>registry.aliyuncs.com/google_containers/metrics-server:v0.3.7</code></li><li>helm å®‰è£… ingress-nginx æŠ¥é”™ï¼Œçœ‹æ˜¯å¦æ˜¯å› ä¸ºåŒ…æ‹‰ä¸ä¸‹æ¥ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šé•œåƒæºé‡æ–°å®‰è£…ï¼ˆå¸è½½ <code>helm uninstall -n ingress-nginx ingress-nginx</code>ï¼‰å³å¯ï¼šk8s v1.18.8 å®‰è£… ingress-nginx:<code>helm install ingress-nginx ingress-nginx/ingress-nginx --namespace ingress-nginx --version 3.41.0 --set controller.image.repository=``registry.aliyuncs.com/google_containers/nginx-ingress-controller</code></li></ul><figure><img src="/assets/662652-20231224221252761-1073116118-BIsQC82k.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="ç›¸å…³æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³æ–‡æ¡£"><span>ç›¸å…³æ–‡æ¡£</span></a></h2><ul><li>å®˜æ–¹æ–‡æ¡£ <ul><li><a href="https://kubernetes.io/zh-cn/docs/setup/" target="_blank" rel="noopener noreferrer">k8så®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://kubernetes.github.io/ingress-nginx/deploy/#running-on-kubernetes-versions-older-than-119" target="_blank" rel="noopener noreferrer">åœ¨ä½äº 1.19 çš„ Kubernetes ç‰ˆæœ¬ä¸Šè¿è¡Œ ingress-nginxçš„è¯´æ˜</a></li></ul></li><li>å‚è€ƒ <ul><li><a href="https://qiuyadongsite.github.io/2019/01/03/framework3-microService-k8s1/" target="_blank" rel="noopener noreferrer">k8så®‰è£…ä¸è¯•éªŒ</a></li><li><a href="https://www.cnblogs.com/binghe001/p/12823763.html" target="_blank" rel="noopener noreferrer">K8S 1.18.2å®‰è£…dashboard</a></li><li><a href="https://www.cnblogs.com/hsyw/p/17804493.html" target="_blank" rel="noopener noreferrer">Ingress-Nginxéƒ¨ç½²</a></li></ul></li><li>ç›¸å…³æ¨è <ul><li><a href="https://juejin.cn/post/7283798251404738560" target="_blank" rel="noopener noreferrer">Hyper-V å®‰è£… CentOS 8.5</a></li><li><a href="https://juejin.cn/post/7283873796977197108" target="_blank" rel="noopener noreferrer">Docker V24 åŠ Docker Compose V2 çš„å®‰è£…åŠä½¿ç”¨</a></li><li><a href="https://juejin.cn/post/7296754422750232576" target="_blank" rel="noopener noreferrer">å‰åç«¯éƒ½ç”¨å¾—ä¸Šçš„ Nginx æ—¥å¸¸ä½¿ç”¨ç»éªŒ</a></li></ul></li></ul><h2 id="åè¯­" tabindex="-1"><a class="header-anchor" href="#åè¯­"><span>åè¯­</span></a></h2><blockquote><p>å‰å‰ååå°è¯•äº†å¥½å‡ æ¬¡æ­å»ºk8s,ä¹‹å‰åŸºæœ¬éƒ½çœ‹ç€è¿™åº§å¤§å±±ï¼Œæœ›è€Œå´æ­¥ï¼Œå„ç§ç†ç”±è€Œç»ˆæ­¢ã€‚å½“æ—¶21ç«‹çš„flagï¼Œç»ˆäºæ˜¯åœ¨è¿™2023çš„æœ«å°¾ç»™å®ç°äº†ã€‚</p><p>ä¸ç§¯ç¡…æ­¥ æ— ä»¥è‡³åƒé‡Œï¼Œä¸å›å…±å‹‰</p></blockquote></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/yimogit/yimogit.github.io/edit/main/src/posts/devops/devops_k8s_install_use.md" aria-label="ç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><!----><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: yimo@wikiglobal.com">yimo</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/posts/devops/devops_prometheus_grafana_install_use_db_site_monitor.html" aria-label="Prometheus+Grafana ç›‘æ§å¹³å°å®è·µ-æ­å»º&amp;å¸¸ç”¨æœåŠ¡ç›‘æ§&amp;å‘Šè­¦"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Prometheus+Grafana ç›‘æ§å¹³å°å®è·µ-æ­å»º&amp;å¸¸ç”¨æœåŠ¡ç›‘æ§&amp;å‘Šè­¦</div></a><a class="route-link auto-link next" href="/posts/devops/devops_docker_to_nexus_deploy_k8s_use.html" aria-label="æ„å»º dotnet&amp;vue åº”ç”¨é•œåƒ-&gt;æ¨é€åˆ° Nexus ä»“åº“-&gt;éƒ¨ç½²ä¸º k8s æœåŠ¡å®è·µ"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">æ„å»º dotnet&amp;vue åº”ç”¨é•œåƒ-&gt;æ¨é€åˆ° Nexus ä»“åº“-&gt;éƒ¨ç½²ä¸º k8s æœåŠ¡å®è·µ<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">æ¬¢è¿æ¥åˆ°æ˜“å¢¨ç½‘ï¼</div><div class="vp-copyright">Copyright Â© 2024 æ˜“å¢¨ </div></footer></div><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BJhRIsgW.js" defer></script>
  </body>
</html>
