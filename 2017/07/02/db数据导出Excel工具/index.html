<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>db数据导出Excel工具 | 易墨&#39;s_Blog</title>
  <meta name="description" content="一个叫做易墨的博客" />
  <meta name="keywords" content="yimo,易墨" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="易墨's_Blog">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一个根据数据库链接字符串，sql语句 即可将结果集导出到Excel的工具 分享，支持sqlserver,mysql。  前因 一个月前朋友找到我，让我帮忙做一个根据sql导出查询结果到Excel的工具（之前帮他一个导入Excel然后按其规则统计数据的工具）。然后扔了我一个SQL语句，瞬间懵比。卧槽。这么多列，我特么得定义这么属性，改了还得重新改程序（一直用EF）。于是思考如何忽略列名，进而如何做">
<meta name="keywords" content="工具">
<meta property="og:type" content="article">
<meta property="og:title" content="db数据导出Excel工具">
<meta property="og:url" content="https://yimogit.github.io/2017/07/02/db数据导出Excel工具/index.html">
<meta property="og:site_name" content="易墨&#39;s_Blog">
<meta property="og:description" content="一个根据数据库链接字符串，sql语句 即可将结果集导出到Excel的工具 分享，支持sqlserver,mysql。  前因 一个月前朋友找到我，让我帮忙做一个根据sql导出查询结果到Excel的工具（之前帮他一个导入Excel然后按其规则统计数据的工具）。然后扔了我一个SQL语句，瞬间懵比。卧槽。这么多列，我特么得定义这么属性，改了还得重新改程序（一直用EF）。于是思考如何忽略列名，进而如何做">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703163425456-1755280588.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703154605675-241795072.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703154657940-1934319122.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703154936019-1655719657.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703182427253-1108288763.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170704092826612-2098151036.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170704092837190-1992148601.png">
<meta property="og:updated_time" content="2018-07-17T07:19:45.859Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="db数据导出Excel工具">
<meta name="twitter:description" content="一个根据数据库链接字符串，sql语句 即可将结果集导出到Excel的工具 分享，支持sqlserver,mysql。  前因 一个月前朋友找到我，让我帮忙做一个根据sql导出查询结果到Excel的工具（之前帮他一个导入Excel然后按其规则统计数据的工具）。然后扔了我一个SQL语句，瞬间懵比。卧槽。这么多列，我特么得定义这么属性，改了还得重新改程序（一直用EF）。于是思考如何忽略列名，进而如何做">
<meta name="twitter:image" content="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703163425456-1755280588.png">
    
  <link rel="stylesheet" href="//yimogit.github.io/assets/css/waves.min.css">
  <link rel="stylesheet" href="//yimogit.github.io/assets/css/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>

<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				易墨's_Blog
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'  target="_top" >
								首页
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'  target="_top" >
								归档
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-gossip' href='/gossip'  target="_top" >
								闲言碎语
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-meTools' href='https://tools.yimo.link/'  target="_blank" >
								个人工具
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-meApp' href='http://app.yimo.link'  target="_blank" >
								私人定制
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'  target="_top" >
								关于
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		

			<a href="/" class="nav-home nav">
				首页
			</a>
		

			<a href="/archives" class="nav-archives nav">
				归档
			</a>
		

			<a href="/gossip" class="nav-gossip nav">
				闲言碎语
			</a>
		

			<a href="https://tools.yimo.link/" class="nav-meTools nav">
				个人工具
			</a>
		

			<a href="http://app.yimo.link" class="nav-meApp nav">
				私人定制
			</a>
		

			<a href="/about" class="nav-about nav">
				关于
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-db数据导出Excel工具"
  class="post white-box article-type-post"
  itemscope itemprop="blogPost">
	<section class='meta'>
	<h2 class="title">
  	<a href="/2017/07/02/db数据导出Excel工具/">
    	db数据导出Excel工具 
    </a>
  </h2>	
	
	<time>
	  2017-07-03 07:13:49
	</time>
	
	
    
    <div class='cats'>
        <a href="/categories/dotnet/">dotnet</a>
    </div>

	</section>
	
		<section class="toc-wrapper"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前因"><span class="toc-number">1.</span> <span class="toc-text">前因</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如何完成这个需求"><span class="toc-number">2.</span> <span class="toc-text">如何完成这个需求</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-创建项目-预览"><span class="toc-number">2.1.</span> <span class="toc-text">0. 创建项目-预览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-到github仓库clone了源码至本地生成需要的dll，然后在项目中添加了引用"><span class="toc-number">2.2.</span> <span class="toc-text">1. 到github仓库clone了源码至本地生成需要的dll，然后在项目中添加了引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-使用SqlSugar获取结果到DataTable中-不知道是不是最近帮朋友写ado-net的代码写多了，感觉挺好"><span class="toc-number">2.3.</span> <span class="toc-text">2. 使用SqlSugar获取结果到DataTable中(不知道是不是最近帮朋友写ado.net的代码写多了，感觉挺好)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-DataTable转Excel"><span class="toc-number">2.4.</span> <span class="toc-text">3. DataTable转Excel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-使用Ini文件保存输入"><span class="toc-number">2.5.</span> <span class="toc-text">4. 使用Ini文件保存输入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-文本框全选功能"><span class="toc-number">2.6.</span> <span class="toc-text">5. 文本框全选功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-打开保存的excel"><span class="toc-number">2.7.</span> <span class="toc-text">6. 打开保存的excel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-页面主要功能代码"><span class="toc-number">2.8.</span> <span class="toc-text">7. 页面主要功能代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#winform中使用多线程时给ui控件赋值"><span class="toc-number">2.8.1.</span> <span class="toc-text">winform中使用多线程时给ui控件赋值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-一些记录"><span class="toc-number">2.9.</span> <span class="toc-text">8. 一些记录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#winform中使用多线程时给ui控件赋值-1"><span class="toc-number">2.9.1.</span> <span class="toc-text">winform中使用多线程时给ui控件赋值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#整个过程解决了一下问题"><span class="toc-number">2.9.2.</span> <span class="toc-text">整个过程解决了一下问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#源码"><span class="toc-number">2.9.3.</span> <span class="toc-text">源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用说明"><span class="toc-number">2.9.4.</span> <span class="toc-text">使用说明</span></a></li></ol></li></ol></li></ol></section>
	
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<blockquote>
<p>一个根据数据库链接字符串，sql语句 即可将结果集导出到Excel的工具 分享，支持sqlserver,mysql。</p>
</blockquote>
<h1 id="前因"><a href="#前因" class="headerlink" title="前因"></a>前因</h1><blockquote>
<p>一个月前朋友找到我，让我帮忙做一个根据sql导出查询结果到Excel的工具（之前帮他一个导入Excel然后按其规则统计数据的工具）。<br>然后扔了我一个SQL语句，瞬间懵比。卧槽。这么多列，我特么得定义这么属性，改了还得重新改程序（一直用EF）。<br>于是思考如何忽略列名，进而如何做到通用，做到于我有益，而不是简单的帮个忙。</p>
</blockquote>
<h1 id="如何完成这个需求"><a href="#如何完成这个需求" class="headerlink" title="如何完成这个需求"></a>如何完成这个需求</h1><blockquote>
<p>Q:程序中根据SQL查询出数据而不需要关注有哪些列？<br>A:将查询结果保存到DataTable中然后遍历<br>Q:如何将DataTable转换Excel？<br>A:一搜，一试，可用之<br>Q:如何保存到本地？<br>A:待我改改写日志的方法<br><a id="more"></a><br>使用<a href="http://www.codeisbug.com/Doc/8" target="_blank" rel="noopener"><code>SqlSugar 4.x</code></a> 进行数据操作<br>SqlSugar 4.x是一款高性能（达到ADO.NET最高性能水平）、轻量级、支持多库和人性化语法的ORM，语法方便，入门简单，功能强大。<br>对数据库结构没太多要求，支持多主键，多自增列<br>SqlSugar支持sqlserver,mysql故此工具适用于此两者数据库</p>
</blockquote>
<h2 id="0-创建项目-预览"><a href="#0-创建项目-预览" class="headerlink" title="0. 创建项目-预览"></a>0. 创建项目-预览</h2><p><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703163425456-1755280588.png" alt="">       </p>
<h2 id="1-到github仓库clone了源码至本地生成需要的dll，然后在项目中添加了引用"><a href="#1-到github仓库clone了源码至本地生成需要的dll，然后在项目中添加了引用" class="headerlink" title="1. 到github仓库clone了源码至本地生成需要的dll，然后在项目中添加了引用"></a>1. 到github仓库clone了源码至本地生成需要的dll，然后在项目中添加了引用</h2><p><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703154605675-241795072.png" alt=""><br><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703154657940-1934319122.png" alt="">           </p>
<h2 id="2-使用SqlSugar获取结果到DataTable中-不知道是不是最近帮朋友写ado-net的代码写多了，感觉挺好"><a href="#2-使用SqlSugar获取结果到DataTable中-不知道是不是最近帮朋友写ado-net的代码写多了，感觉挺好" class="headerlink" title="2. 使用SqlSugar获取结果到DataTable中(不知道是不是最近帮朋友写ado.net的代码写多了，感觉挺好)"></a>2. 使用SqlSugar获取结果到DataTable中(不知道是不是最近帮朋友写ado.net的代码写多了，感觉挺好)</h2><p><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703154936019-1655719657.png" alt="">       </p>
<h2 id="3-DataTable转Excel"><a href="#3-DataTable转Excel" class="headerlink" title="3. DataTable转Excel"></a>3. DataTable转Excel</h2><pre><code>public class DataTableToExcel
{
    private DataTableToExcel()
    { }
    private static DataTableToExcel _instance = null;

    public static DataTableToExcel Instance
    {
        get
        {
            if (_instance == null) _instance = new DataTableToExcel();
            return _instance;
        }
    }
    /// &lt;summary&gt;
    /// DataTable通过流导出Excel
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;ds&quot;&gt;数据源DataSet&lt;/param&gt;
    /// &lt;param name=&quot;columns&quot;&gt;DataTable中列对应的列名(可以是中文),若为null则取DataTable中的字段名&lt;/param&gt;
    /// &lt;param name=&quot;fileName&quot;&gt;保存文件名(例如：a.xls)&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public string StreamExport(DataTable dt, string[] columns = null,string savePath=&quot;&quot;)
    {
        //if (dt.Rows.Count &gt; 65535) //总行数大于Excel的行数 
        //{
        //    throw new Exception(&quot;预导出的数据总行数大于excel的行数&quot;);
        //}

        StringBuilder content = new StringBuilder();
        content.Append(&quot;&lt;html xmlns:o=&apos;urn:schemas-microsoft-com:office:office&apos; xmlns:x=&apos;urn:schemas-microsoft-com:office:excel&apos; xmlns=&apos;http://www.w3.org/TR/REC-html40&apos;&gt;&quot;);
        content.Append(&quot;&lt;head&gt;&lt;title&gt;&lt;/title&gt;&lt;meta http-equiv=&apos;Content-Type&apos; content=\&quot;text/html; charset=gb2312\&quot;&gt;&quot;);
        //注意：[if gte mso 9]到[endif]之间的代码，用于显示Excel的网格线，若不想显示Excel的网格线，可以去掉此代码
        content.Append(&quot;&lt;!--[if gte mso 9]&gt;&quot;);
        content.Append(&quot;&lt;xml&gt;&quot;);
        content.Append(&quot; &lt;x:ExcelWorkbook&gt;&quot;);
        content.Append(&quot;  &lt;x:ExcelWorksheets&gt;&quot;);
        content.Append(&quot;   &lt;x:ExcelWorksheet&gt;&quot;);
        content.Append(&quot;    &lt;x:Name&gt;Sheet1&lt;/x:Name&gt;&quot;);
        content.Append(&quot;    &lt;x:WorksheetOptions&gt;&quot;);
        content.Append(&quot;      &lt;x:Print&gt;&quot;);
        content.Append(&quot;       &lt;x:ValidPrinterInfo /&gt;&quot;);
        content.Append(&quot;      &lt;/x:Print&gt;&quot;);
        content.Append(&quot;    &lt;/x:WorksheetOptions&gt;&quot;);
        content.Append(&quot;   &lt;/x:ExcelWorksheet&gt;&quot;);
        content.Append(&quot;  &lt;/x:ExcelWorksheets&gt;&quot;);
        content.Append(&quot;&lt;/x:ExcelWorkbook&gt;&quot;);
        content.Append(&quot;&lt;/xml&gt;&quot;);
        content.Append(&quot;&lt;![endif]--&gt;&quot;);
        content.Append(&quot;&lt;/head&gt;&lt;body&gt;&lt;table style=&apos;border-collapse:collapse;table-layout:fixed;&apos;&gt;&lt;tr&gt;&quot;);

        if (columns != null)
        {
            for (int i = 0; i &lt; columns.Length; i++)
            {
                if (columns[i] != null &amp;&amp; columns[i] != &quot;&quot;)
                {
                    content.Append(&quot;&lt;td&gt;&lt;b&gt;&quot; + columns[i] + &quot;&lt;/b&gt;&lt;/td&gt;&quot;);
                }
                else
                {
                    content.Append(&quot;&lt;td&gt;&lt;b&gt;&quot; + dt.Columns[i].ColumnName + &quot;&lt;/b&gt;&lt;/td&gt;&quot;);
                }
            }
        }
        else
        {
            for (int j = 0; j &lt; dt.Columns.Count; j++)
            {
                content.Append(&quot;&lt;td&gt;&lt;b&gt;&quot; + dt.Columns[j].ColumnName + &quot;&lt;/b&gt;&lt;/td&gt;&quot;);
            }
        }
        content.Append(&quot;&lt;/tr&gt;\n&quot;);

        for (int j = 0; j &lt; dt.Rows.Count; j++)
        {
            content.Append(&quot;&lt;tr&gt;&quot;);
            for (int k = 0; k &lt; dt.Columns.Count; k++)
            {
                object obj = dt.Rows[j][k];
                Type type = obj.GetType();
                if (type.Name == &quot;Int32&quot; || type.Name == &quot;Single&quot; || type.Name == &quot;Double&quot; || type.Name == &quot;Decimal&quot;)
                {
                    double d = obj == DBNull.Value ? 0.0d : Convert.ToDouble(obj);
                    if (type.Name == &quot;Int32&quot; || (d - Math.Truncate(d) == 0))
                        content.AppendFormat(&quot;&lt;td style=&apos;vnd.ms-excel.numberformat:#,##0&apos;&gt;{0}&lt;/td&gt;&quot;, obj);
                    else
                        content.AppendFormat(&quot;&lt;td style=&apos;vnd.ms-excel.numberformat:#,##0.00&apos;&gt;{0}&lt;/td&gt;&quot;, obj);
                }
                else
                    content.AppendFormat(&quot;&lt;td style=&apos;vnd.ms-excel.numberformat:@&apos;&gt;{0}&lt;/td&gt;&quot;, obj);
            }
            content.Append(&quot;&lt;/tr&gt;\n&quot;);
        }
        content.Append(&quot;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;&quot;);
        content.Replace(&quot;&amp;nbsp;&quot;, &quot;&quot;);
        using (var w = new StreamWriter(savePath, false, Encoding.UTF8))
        {
            w.WriteLine(content);
        }
        return savePath;
    }
}
</code></pre><h2 id="4-使用Ini文件保存输入"><a href="#4-使用Ini文件保存输入" class="headerlink" title="4. 使用Ini文件保存输入"></a>4. 使用Ini文件保存输入</h2><pre><code>public class IniHelper
{
    // 声明INI文件的写操作函数 WritePrivateProfileString()
    [System.Runtime.InteropServices.DllImport(&quot;kernel32&quot;)]
    private static extern long WritePrivateProfileString(string section, string key, string val, string filePath);

    // 声明INI文件的读操作函数 GetPrivateProfileString()
    [System.Runtime.InteropServices.DllImport(&quot;kernel32&quot;)]
    private static extern int GetPrivateProfileString(string section, string key, string def, System.Text.StringBuilder retVal, int size, string filePath);

    private int retLength = 500;
    private string sPath = null;
    public IniHelper(string path, int rl = 500)
    {
        this.sPath = path;
        if (rl &gt; 0)
        {
            this.retLength = rl;
        }
    }

    public void WriteValue(string key, string value, string section = &quot;Setting&quot;)
    {
        // section=配置节，key=键名，value=键值，path=路径
        WritePrivateProfileString(section, key, value, sPath);
    }

    public string ReadValue(string key, string section = &quot;Setting&quot;)
    {
        // 每次从ini中读取多少字节
        System.Text.StringBuilder temp = new System.Text.StringBuilder(retLength);
        // section=配置节，key=键名，temp=上面，path=路径
        GetPrivateProfileString(section, key, &quot;&quot;, temp, retLength, sPath);
        return temp.ToString();
    }
}
</code></pre><h2 id="5-文本框全选功能"><a href="#5-文本框全选功能" class="headerlink" title="5. 文本框全选功能"></a>5. 文本框全选功能</h2><pre><code>public frmMain()
{

    this.ControlAdded += new System.Windows.Forms.ControlEventHandler(this.Control_ControlAdded); //注册全选功能
    InitializeComponent();
}
#region 文本框能够使用Ctrl+A 全选功能
private void Control_ControlAdded(object sender, ControlEventArgs e)
{
    //使“未来”生效
    e.Control.ControlAdded += new System.Windows.Forms.ControlEventHandler(this.Control_ControlAdded);
    //使“子孙”生效
    foreach (Control c in e.Control.Controls)
    {
        Control_ControlAdded(sender, new ControlEventArgs(c));
    }
    //使“过去”生效
    TextBox textBox = e.Control as TextBox;
    if (textBox != null)
    {
        textBox.KeyPress += TextBox_KeyPress;
    }
}
private void TextBox_KeyPress(object sender, KeyPressEventArgs e)
{
    TextBox textBox = sender as TextBox;
    if (textBox == null)
        return;
    if (e.KeyChar == (char)1)
    {
        textBox.SelectAll();
        e.Handled = true;
    }
}
#endregion
</code></pre><h2 id="6-打开保存的excel"><a href="#6-打开保存的excel" class="headerlink" title="6. 打开保存的excel"></a>6. 打开保存的excel</h2><pre><code>private void btnOpenDir_Click(object sender, EventArgs e)
{
    var txtFileName = this.txtFileName.Text;
    var txtExportDir = this.txtExportDir.Text;
    var openPath = Path.Combine(txtExportDir, txtFileName);
    if (File.Exists(openPath))
    {
        System.Diagnostics.Process.Start(openPath, &quot;c:\\windows&quot;);
    }
    else
    {
        AppendTipMsg(&quot;文件&quot; + openPath + &quot;不存在&quot;);
    }
}
</code></pre><h2 id="7-页面主要功能代码"><a href="#7-页面主要功能代码" class="headerlink" title="7. 页面主要功能代码"></a>7. 页面主要功能代码</h2><p><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170703182427253-1108288763.png" alt=""></p>
<h3 id="winform中使用多线程时给ui控件赋值"><a href="#winform中使用多线程时给ui控件赋值" class="headerlink" title="winform中使用多线程时给ui控件赋值"></a>winform中使用多线程时给ui控件赋值</h3><pre><code>var txtThread = new Thread(() =&gt; txtMsg.BeginInvoke(new Action(() =&gt; txtMsg.AppendText(&quot;向文本框中追加内容&quot;))));   
txtThread.Start();
</code></pre><h2 id="8-一些记录"><a href="#8-一些记录" class="headerlink" title="8. 一些记录"></a>8. 一些记录</h2><h3 id="winform中使用多线程时给ui控件赋值-1"><a href="#winform中使用多线程时给ui控件赋值-1" class="headerlink" title="winform中使用多线程时给ui控件赋值"></a>winform中使用多线程时给ui控件赋值</h3><pre><code>var txtThread = new Thread(() =&gt; txtMsg.BeginInvoke(new Action(() =&gt; txtMsg.AppendText(&quot;向文本框中追加内容&quot;))));   
txtThread.Start();
</code></pre><p>源码中的NopI组件可移除，此工具实际未用到    </p>
<p>开启线程执行导出的时候使用的是Task.Run(() =&gt;{});若将框架版本改为4.0则需要将此处修改为new Thread(() =&gt;{}).Start();        </p>
<h3 id="整个过程解决了一下问题"><a href="#整个过程解决了一下问题" class="headerlink" title="整个过程解决了一下问题"></a>整个过程解决了一下问题</h3><blockquote>
<ol start="0">
<li>数据库查询（SqlSugar支持sqlserver,mysql）</li>
<li>datatable转excel文本</li>
<li>ini存取文件</li>
<li>winform文本框全选功能</li>
<li>winform中使用多线程时给ui控件赋值</li>
</ol>
</blockquote>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><blockquote>
<p>下载使用：<a href="http://files.cnblogs.com/files/morang/DB数据导出工具.rar" target="_blank" rel="noopener">http://files.cnblogs.com/files/morang/DB数据导出工具.rar</a><br>源码下载：<a href="http://files.cnblogs.com/files/morang/DB数据导出工具_源码.rar" target="_blank" rel="noopener">http://files.cnblogs.com/files/morang/DB数据导出工具_源码.rar</a><br>Coding地址：<a href="https://coding.net/u/yimocoding/p/WeDemo/git/tree/NopiExcelDemo" target="_blank" rel="noopener">https://coding.net/u/yimocoding/p/WeDemo/git/tree/NopiExcelDemo</a><br>git克隆：<code>git clone https://git.coding.net/yimocoding/WeDemo.git -b NopiExcelDemo</code></p>
</blockquote>
<h3 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h3><p><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170704092826612-2098151036.png" alt=""><br><img src="http://images2015.cnblogs.com/blog/662652/201707/662652-20170704092837190-1992148601.png" alt=""></p>

  	</div>
	  
	  <div class="article-tags tags">
      
        <a href="/tags/工具/">工具</a>
      
	  </div>
    
	  
		<div class="art-item-footer">
				
					<span class="art-item-left"><i class="icon icon-chevron-thin-left"></i>上一篇：<a href="/2017/07/02/大话数据结构笔记/" rel="prev"  title="大话数据结构-阅读笔记">
						大话数据结构-阅读笔记 
					</a></span>
				
				
					<span class="art-item-right">下一篇：<a href="/2017/06/03/使用批处理脚本愉快的清理缓存/" rel="next"  title="使用批处理脚本愉快的清理缓存">
						使用批处理脚本愉快的清理缓存
					</a><i class="icon icon-chevron-thin-right"></i></span>
				
		</div>
		
	</section>
	
		<section id="comments">
				<div id="SOHUCS" sid="db数据导出Excel工具"></div>
		</section>
		
    <script charset="utf-8" type="text/javascript" src="//changyan.sohu.com/upload/changyan.js"></script>
    <script type="text/javascript">
        window.changyan.api.config({ appid: 'cys5no60I', conf: 'prod_b1c091f2c20426abdaa5aa83a7f0c12c' });
    </script>

	
</article>
<script>
	window.subData = {
		title: 'db数据导出Excel工具',
		tools: true
	}
</script>


      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='/images/avatar.jpg' />

<div class='header'>易墨</div>
<div class='content'>
<div class='desc'><b>过去过不的都会过去</b></div>
</div>
</section>

  
<section class='m_widget links'>
<div class='header'>友情链接</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://tools.yimo.link/">
            <div class='name'>metools</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="http://www.yalunwang.com/">
            <div class='name'>知乐博客</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="http://szhshp.org/">
            <div class='name'>szhshp的第三边境研究所</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://m.kuaidi100.com/">
            <div class='name'>快递查询</div>
        </a></li>
    
    </ul>
</div>
</section>


  
<section class='m_widget categories'>
<div class='header'>分了个类</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/dotnet/"><div class='name'>dotnet</div><div class='badget'>8</div></a></li>
    
        <li><a class="flat-box" href="/categories/web开发/"><div class='name'>web开发</div><div class='badget'>6</div></a></li>
    
        <li><a class="flat-box" href="/categories/全栈/"><div class='name'>全栈</div><div class='badget'>14</div></a></li>
    
        <li><a class="flat-box" href="/categories/程序猿之路/"><div class='name'>程序猿之路</div><div class='badget'>1</div></a></li>
    
    </ul>
    
</div>
</section>


  
<div class="m_widget tagcloud">
    <div class="header">标了个签</div>
    <div class='content' id="tagscloud">
        <a href="/tags/css/" style="font-size: 14px; color: #808080">css</a> <a href="/tags/dotnet/" style="font-size: 16px; color: #555">dotnet</a> <a href="/tags/express/" style="font-size: 14px; color: #808080">express</a> <a href="/tags/git/" style="font-size: 16px; color: #555">git</a> <a href="/tags/hexo/" style="font-size: 16px; color: #555">hexo</a> <a href="/tags/js/" style="font-size: 18px; color: #2b2b2b">js</a> <a href="/tags/linux/" style="font-size: 14px; color: #808080">linux</a> <a href="/tags/msmq/" style="font-size: 14px; color: #808080">msmq</a> <a href="/tags/netcore/" style="font-size: 14px; color: #808080">netcore</a> <a href="/tags/nodejs/" style="font-size: 16px; color: #555">nodejs</a> <a href="/tags/nopi/" style="font-size: 14px; color: #808080">nopi</a> <a href="/tags/python/" style="font-size: 14px; color: #808080">python</a> <a href="/tags/react/" style="font-size: 14px; color: #808080">react</a> <a href="/tags/react-native/" style="font-size: 14px; color: #808080">react-native</a> <a href="/tags/weex/" style="font-size: 14px; color: #808080">weex</a> <a href="/tags/工具/" style="font-size: 20px; color: #000">工具</a> <a href="/tags/持续集成/" style="font-size: 14px; color: #808080">持续集成</a> <a href="/tags/环境搭建/" style="font-size: 14px; color: #808080">环境搭建</a> <a href="/tags/脚本/" style="font-size: 16px; color: #555">脚本</a> <a href="/tags/读书笔记/" style="font-size: 14px; color: #808080">读书笔记</a> <a href="/tags/闲言碎语/" style="font-size: 14px; color: #808080">闲言碎语</a>
    </div>
</div>




      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/yimogit" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://coding.net/u/yimocoding" class="social coding"
          target="_blank" rel="external">
          <span class="icon icon-coding"></span>
        </a>
      
        <a href="http://www.cnblogs.com/morang/" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">
    本站总访问量:<span id="busuanzi_value_site_pv">...</span>
</span>
<br/>
<span id="busuanzi_container_site_uv"> 
  本站访客数:<span id="busuanzi_value_site_uv">...</span>
</span>
  
  
    <div>hexo 主题 <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename">MaterialFlow</a> designed By <a href="//keyin.me/" target="_blank">Kevin Tan</a>.</div>
  
    <div>本站托管于 <a href='https://coding.net/u/yimocoding/p/yimocoding/git' class="codename">coding.net</a> By <a href="//www.yimo.link/" target="_blank">易墨</a></div>
</footer>


  <script>setLoadingBarProgress(80);</script>
  
<script src="//yimogit.github.io/assets/js/jquery.min.js"></script>
<script src="//yimogit.github.io/assets/js/waves.min.js"></script>
<script src="//yimogit.github.io/assets/js/scrollreveal.min.js"></script>
<script src="//yimogit.github.io/assets/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="//yimogit.github.io/assets/js/search.js"></script>
<script src="//yimogit.github.io/assets/js/app.js"></script>
<script>
  InitTongJi("undefined");
</script>

  <script>setLoadingBarProgress(100);</script>
</body>
</html>
